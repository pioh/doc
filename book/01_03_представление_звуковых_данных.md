[← К оглавлению](README.md)

---

# [Глава 1.3](01_03_представление_звуковых_данных.md): Представление звуковых данных в двоичном коде

## Введение

Значит так, всю музыку в твоём Spotify, все подкасты, весь звук в играх - всё это когда-то было аналоговыми волнами в воздухе, а теперь это нули и единицы. Как так получилось? Как компьютер запихивает непрерывную звуковую волну в дискретные байты?

Сейчас разберёмся, как оцифровывается звук, почему качество CD - это 44.1 кГц / 16 бит, и почему MP3-файл весит в 10 раз меньше, чем WAV. А ещё поймёшь, почему аудиофилы готовы убить за FLAC, хотя на дешёвых наушниках разницы не услышать.

## Физика звука (коротко, чтоб не уснуть)

**Звук** - это колебания воздуха (или другой среды). Характеристики:
- **Частота** (Гц) - высота тона (басы vs писк)
- **Амплитуда** - громкость
- **Тембр** - почему скрипка звучит не как труба

Человек слышит от 20 Гц до 20 кГц. С возрастом верхняя граница опускается до 15-16 кГц (привет, тиннитус после концертов).

Звук - это **непрерывный** (аналоговый) сигнал. А компьютер работает только с **дискретными** (прерывистыми) данными. Как превратить одно в другое? Дискретизация и квантование, вот как.

## Дискретизация и квантование (оцифровка звука)

### Дискретизация (sampling)

**Дискретизация** - это измерение амплитуды звука через равные промежутки времени. Каждое измерение - это **отсчёт** (sample, сэмпл).

**Частота дискретизации (sample rate)** - сколько раз в секунду ты измеряешь амплитуду. Измеряется в герцах (Гц) или килогерцах (кГц).

Примеры:
- **44100 Гц (44.1 кГц)** - стандарт Audio CD
- **48 кГц** - профессиональное аудио, видео
- **8 кГц** - телефонная связь (хватит для разборчивости речи)

**Теорема Котельникова-Найквиста** (нобелевский уровень математики, но простыми словами):  
Чтобы точно восстановить аналоговый сигнал из цифрового, частота дискретизации должна быть **минимум в 2 раза больше** максимальной частоты звука.

Человек слышит до 20 кГц → нужна частота дискретизации минимум 40 кГц. Поэтому Audio CD использует 44.1 кГц (с запасом).

### Квантование (quantization)

**Квантование** - это превращение измеренной амплитуды в цифровое значение с ограниченной точностью.

**Разрядность квантования (bit depth)** - сколько битов выделяется на один отсчёт. Определяет точность и динамический диапазон.

Варианты:
- **8 бит**: 2⁸ = 256 уровней (звучит как дерьмо, привет 90-е)
- **16 бит**: 2¹⁶ = 65536 уровней (стандарт CD, вполне збс)
- **24 бита**: 2²⁴ = 16.7 миллионов уровней (профессиональное аудио, аудиофилы кончают)
- **32 бита**: 2³² = 4.3 миллиарда уровней (обычно float, для обработки звука)

Чем больше бит, тем точнее амплитуда, тем больше динамический диапазон (разница между тихим и громким звуком).

### Количество каналов

**Моно** - один канал, звук одинаковый из всех динамиков.  
**Стерео** - два канала (левый и правый), создаёт ощущение пространства.  
**Многоканальные форматы** - 5.1, 7.1 (для домашних кинотеатров, игр).

## Расчёт объёма несжатого аудио

### Формула (запомни её нахрен)

```
Объём (байт) = (Частота × Разрядность × Каналы × Длительность) / 8
```

Где:
- Частота (f) - в герцах (Гц)
- Разрядность (b) - в битах
- Каналы (c) - количество
- Длительность (t) - в секундах

Делим на 8, потому что 8 бит = 1 байт.

### Примеры (считай вместе со мной)

**Пример 1: Одна минута Audio CD**

Дано:
- Частота: 44100 Гц
- Разрядность: 16 бит
- Каналы: 2 (стерео)
- Длительность: 60 секунд

Решение:
```
V = (44100 × 16 × 2 × 60) / 8
V = 84672000 / 8
V = 10584000 байт
V ≈ 10.09 МБ
```

**Ответ**: одна минута Audio CD ~ **10 МБ**.

Проверка: CD вмещает ~74 минуты, то есть ~740 МБ, что соответствует объёму CD-диска (700 МБ). Всё сходится!

**Пример 2: Моно vs стерео**

Вопрос: во сколько раз стерео больше моно?

Ответ: ровно в **2 раза**. Потому что:
```
V_стерео / V_моно = (f × b × 2 × t) / (f × b × 1 × t) = 2
```

Всё просто.

**Пример 3: Влияние разрядности**

Дано:
- Частота: 22050 Гц
- Длительность: 5 секунд
- Моно
- Разрядности: 8 бит и 16 бит

Для 8 бит:
```
V₁ = (22050 × 8 × 1 × 5) / 8 = 110250 байт ≈ 107.7 КБ
```

Для 16 бит:
```
V₂ = (22050 × 16 × 1 × 5) / 8 = 220500 байт ≈ 215.3 КБ
```

**Ответ**: при увеличении разрядности с 8 до 16 бит объём удваивается.

**Пример 4: Обратная задача (длительность по размеру файла)**

Дано:
- Файл WAV: 5 МБ
- Частота: 48 кГц
- Разрядность: 16 бит
- Стерео

Найти длительность (t).

Из формулы V = (f × b × c × t) / 8 выражаем t:
```
t = (V × 8) / (f × b × c)
t = (5 × 1024 × 1024 × 8) / (48000 × 16 × 2)
t = 41943040 / 1536000
t ≈ 27.3 секунды
```

**Ответ**: ~27 секунд.

**Пример 5: Эффект сжатия MP3**

Дано:
- Стереозапись: 3 минуты
- Формат CD: 44.1 кГц, 16 бит
- MP3: битрейт 192 кбит/с

Размер WAV:
```
V_WAV = (44100 × 16 × 2 × 180) / 8
V_WAV = 254016000 байт ≈ 242 МБ
```

Размер MP3 (для MP3 битрейт уже показывает скорость):
```
Битрейт = 192 кбит/с = 192000 бит/с = 24000 байт/с
V_MP3 = 24000 × 180 = 4320000 байт ≈ 4.1 МБ
```

Коэффициент сжатия:
```
K = 242 / 4.1 ≈ 59
```

**Ответ**: MP3 занимает примерно в **59 раз** меньше места, чем несжатый WAV. Охуеть какая экономия!

## Форматы аудиофайлов

### Несжатые форматы (жрут память как не в себя)

**WAV (Waveform Audio File Format)** - стандарт для Windows (Microsoft + IBM). Хранит несжатые PCM-данные (Pulse Code Modulation - импульсно-кодовая модуляция). Максимальное качество, но размер пиздец.

**AIFF (Audio Interchange File Format)** - аналог WAV для Macintosh (Apple). То же самое, только для яблочников.

### Сжатие без потерь (lossless)

**FLAC (Free Lossless Audio Codec)** - сжимает в 1.5-2 раза без потери качества. После распаковки получишь точно такой же WAV. Аудиофилы обожают, но не все плееры поддерживают.

**ALAC (Apple Lossless Audio Codec)** - то же самое от Apple, для экосистемы яблок.

**APE (Monkey's Audio)** - сжимает сильнее, но медленнее кодирует/декодирует.

### Сжатие с потерями (lossy) - выкидываем то, что ухо не слышит

**MP3 (MPEG-1 Audio Layer 3)** - самый популярный формат сжатого аудио. Использует психоакустическую модель: выкидывает звуки, которые человек плохо слышит (например, тихие звуки рядом с громкими). Сжимает в 10-12 раз при приемлемом качестве.

Битрейты:
- **128 кбит/с** - стандартное качество (заметна потеря качества)
- **192 кбит/с** - хорошее качество
- **256-320 кбит/с** - высокое качество (для большинства людей неотличимо от CD)

**AAC (Advanced Audio Coding)** - более современный, чем MP3. При том же битрейте звучит лучше. Используется в iTunes, YouTube, мобильных устройствах.

**OGG Vorbis** - свободный формат с открытым исходным кодом, альтернатива MP3. Хорошее качество, но менее популярен.

**Opus** - современный универсальный кодек с низкой задержкой. Оптимизирован как для речи, так и для музыки. Используется в VoIP (Discord, WhatsApp), потоковом вещании. Один из лучших кодеков на сегодня.

## Стандарты качества

### Audio CD (1982, стандарт до сих пор жив)

- Частота: 44.1 кГц
- Разрядность: 16 бит
- Стерео
- Эталон качества для потребительского аудио

### Профессиональное аудио

- Частота: 48 кГц, 96 кГц, 192 кГц
- Разрядность: 24 бита или 32 бита (float)
- Для звукозаписи, мастеринга, кино

### Телефонная связь (главное - разборчивость речи)

- Частота: 8 кГц
- Разрядность: 8 бит
- Моно
- Звучит как говно, но слова понятны, а это главное для телефонии

## Зачем всё это нужно?

1. **Аудиопроизводство**: выбор параметров записи в зависимости от задачи (музыка, речь, подкаст)
2. **Разработка приложений**: оптимизация использования памяти и трафика
3. **Стриминговые сервисы**: баланс между качеством и скоростью интернета
4. **Мобильные приложения**: экономия памяти и трафика (важно на мобильном)
5. **Игры**: звук должен быть качественным, но не жрать всю память

Современные тренды:
- **Адаптивное качество**: стриминг подстраивает битрейт под скорость интернета
- **Hi-Res Audio**: 96 кГц / 24 бита и выше для аудиофилов
- **Пространственное аудио**: Dolby Atmos, 3D-звук

## Основные термины

**Звук** - механические колебания среды.

**Дискретизация (sampling)** - измерение амплитуды через равные промежутки времени.

**Частота дискретизации (sample rate)** - сколько раз в секунду измеряется амплитуда (Гц).

**Квантование (quantization)** - превращение амплитуды в цифровое значение.

**Разрядность квантования (bit depth)** - сколько бит на один отсчёт.

**Теорема Найквиста** - частота дискретизации должна быть минимум в 2 раза больше максимальной частоты сигнала.

**Отсчёт (sample, сэмпл)** - одно измерение амплитуды.

**Канал** - независимый аудиопоток (моно=1, стерео=2).

**PCM (Pulse Code Modulation)** - импульсно-кодовая модуляция, метод представления аналогового сигнала в цифровом виде.

**Битрейт (bitrate)** - сколько бит в секунду используется для кодирования звука.

**Динамический диапазон** - разница между самым громким и самым тихим звуком.

**Lossless** - сжатие без потерь качества.

**Lossy** - сжатие с потерями, часть информации выбрасывается.

## Контрольные вопросы

1. **Теория**: Объясни процесс оцифровки звука. Зачем нужны дискретизация и квантование?

2. **Найквист**: Какая минимальная частота дискретизации нужна для сигнала с максимальной частотой 15 кГц? Почему для Audio CD выбрана частота 44.1 кГц, а не 30 кГц?

3. **Расчёт**: Посчитай размер 2-минутной записи телефонного разговора (моно, 8 кГц, 8 бит). Сравни с размером Audio CD той же длительности.

4. **Форматы**: В чём разница между FLAC и MP3? Когда использовать каждый?

5. **Практика**: Файл MP3 длиной 4 минуты занимает 7.2 МБ. Определи средний битрейт (в кбит/с).

## Связь с другими главами

- [**[Глава 1.2](01_02_представление_данных_эвм.md)**](01_02_представление_данных_эвм.md) - представление данных в памяти, как хранятся аудиоданные
- [**[Глава 1.12](01_12_сжатие_информации.md)**](01_12_сжатие_информации.md) - способы сжатия информации (RLE, Хаффман, LZW)
- **Раздел 8** - сетевые протоколы, передача аудио по сети

## Резюме

Что запомнить:

✅ Звук - аналоговый сигнал, компьютер - цифровой → нужна оцифровка  
✅ Дискретизация - измерение амплитуды N раз в секунду  
✅ Квантование - превращение амплитуды в число  
✅ Теорема Найквиста: частота дискретизации ≥ 2 × максимальная частота сигнала  
✅ Audio CD: 44.1 кГц / 16 бит / стерео ≈ 10 МБ/мин  
✅ WAV - несжатый (пиздец большой), FLAC - без потерь (норм), MP3 - с потерями (жрёт мало)  
✅ Чем выше частота и разрядность - тем лучше качество, но больше размер  

Теперь ты понимаешь, что такое 44.1 кГц / 16 бит и почему MP3 весит меньше. И теперь можешь объяснить аудиофилам, почему их FLAC-коллекция жрёт терабайты.

---

_Конец главы_


---

[← К оглавлению](README.md)

*Глава 1.3: Представление звуковых данных в двоичном коде*
