[← К оглавлению](README.md)

---

# [Глава 9.3](09_03_понятия_иб_угрозы.md). Понятия информационной безопасности. Угрозы

## Введение: Почему твои данные интересуют хакеров больше, чем тебя самого?

Окей, дружище, вот мы уже разобрали **политику безопасности** ([Глава 9.01](09_01_политика_безопасности.md)) и **криптографию** ([Глава 9.02](09_02_криптографические_методы.md)). Научились делать правила, шифровать данные, ставить пароли. Но есть нюанс: всё это нужно, потому что **существуют угрозы**. Куча людей (и не только людей — ещё боты, вирусы, стихийные бедствия) хотят сломать твою систему, украсть данные или просто устроить хаос.

**Реальность**:
- В 2023 году **IBM** опубликовала отчёт: средняя стоимость утечки данных — **$4.45 миллиона**.
- Каждые **39 секунд** происходит кибератака где-то в мире.
- **60%** малого бизнеса закрываются в течение **6 месяцев** после успешной кибератаки.
- Твои данные (email, пароли, банковские карты) стоят на чёрном рынке от **$1** до **$1000** в зависимости от качества.

**Почему это происходит?**

Потому что **информация = деньги**. Хакеры не ломают системы ради спортивного интереса (ну, иногда ради интереса, но чаще — ради денег). Украли базу с номерами кредитных карт → продали на даркнет-форуме → профит. Зашифровали серверы компании → требуют выкуп в биткоинах → профит.

**В этой главе мы разберём:**
- Основные понятия ИБ (актив, уязвимость, угроза, риск)
- Классификация угроз (внутренние vs внешние, природные, техногенные)
- Типы воздействия (конфиденциальность, целостность, доступность → связь с CIA Triad)
- Модель угроз (как понять, от чего защищаться)
- TOP-10 OWASP (самые частые уязвимости веб-приложений)
- Реальные примеры взломов (Equifax, WannaCry, Colonial Pipeline, LastPass)
- Оценка рисков (формула, матрица)

Эта глава связана с:
- **Главой 9.01 (Политика безопасности)** — политика защищает от угроз
- **Главой 9.02 (Криптография)** — шифрование защищает от угроз конфиденциальности
- **Главой 9.04 (Противодействие нарушению конфиденциальности)** — методы защиты от конкретных угроз
- **Главой 9.05 (Способы нарушения конфиденциальности. Атаки)** — конкретные атаки, которые реализуют угрозы
- **Главой 9.06 (Методы реализации угроз)** — технические детали атак
- **Главой 8.04 (Протоколы Internet)** — сетевые угрозы (DDoS, MITM, сниффинг)

---

## 9.3.1. Основные понятия информационной безопасности

Прежде чем говорить об угрозах, разберёмся с базовыми терминами. Это как в покере: прежде чем играть, нужно знать, что такое флоп, ривер и блайнды.

---

### Информационная безопасность (ИБ)

**Определение**: **Защита информации** от несанкционированного **доступа, изменения, уничтожения или утечки**.

**Проще говоря**: Цель ИБ — чтобы:
1. **Конфиденциальность** — секретные данные видели только те, кому положено
2. **Целостность** — данные не изменялись злоумышленниками
3. **Доступность** — легитимные пользователи могли получить доступ, когда нужно

Это **CIA Triad** (Confidentiality, Integrity, Availability), которую мы разбирали в [Глава 9.01](09_01_политика_безопасности.md). Все угрозы в ИБ нарушают хотя бы один из этих принципов.

---

### Актив (Asset)

**Определение**: **Всё, что имеет ценность** для организации и нуждается в защите.

**Примеры активов**:
- **Данные**: база клиентов, финансовые отчёты, медицинские записи, исходный код
- **Оборудование**: серверы, ноутбуки, смартфоны, сетевое оборудование
- **Программное обеспечение**: ОС, СУБД, приложения
- **Персонал**: сотрудники с критичными знаниями (например, системный администратор — единственный, кто знает пароль от root)
- **Репутация**: если утекут данные клиентов, репутация компании пострадает → потеря клиентов

**Пример**: Для банка **главный актив** — база данных с балансами счетов. Если хакеры получат доступ и изменят баланс (например, добавят себе миллион долларов), банк обанкротится.

---

### Уязвимость (Vulnerability)

**Определение**: **Слабое место** в системе, которое можно использовать для атаки.

**Примеры уязвимостей**:
- **Программные**: SQL-инъекция, переполнение буфера (buffer overflow), XSS (Cross-Site Scripting)
- **Конфигурационные**: открытый порт 22 (SSH) на весь интернет, дефолтный пароль admin/admin
- **Человеческие**: сотрудник кликает на фишинговые письма, использует пароль `123456`
- **Физические**: сервер стоит в незапертой комнате

**Пример**: В 2017 году **Equifax** (кредитное бюро) использовало устаревшую версию **Apache Struts** (веб-фреймворк) с известной уязвимостью **CVE-2017-5638**. Патч вышел в марте, но администраторы **не обновили** (забили хуй). В мае хакеры использовали эту уязвимость и украли данные **147 миллионов** человек. Ущерб: $700 миллионов штрафов, увольнение CEO, акции упали на 35%.

**Важно**: Уязвимость сама по себе не опасна, пока её не используют. Это как дырка в заборе: если никто не знает о дырке, она безвредна. Но если воры узнали — всё, жди проблем.

---

### Угроза (Threat)

**Определение**: **Потенциальная опасность**, которая может использовать уязвимость и нанести ущерб активу.

**Примеры угроз**:
- **Внешние**: хакеры, вирусы, DDoS-атаки, конкуренты-шпионы
- **Внутренние**: недовольный сотрудник, случайное удаление файлов
- **Природные**: пожар, наводнение, землетрясение
- **Техногенные**: отключение электричества, авария в дата-центре

**Пример**: Уязвимость — открытый SSH-порт без ограничения IP. Угроза — ботнет пытается подобрать пароль (brute force). Если угроза использует уязвимость → получим **инцидент** (взлом).

---

### Риск (Risk)

**Определение**: **Вероятность** того, что угроза использует уязвимость и нанесёт ущерб.

**Формула**:
```
Риск = Вероятность × Ущерб
```

**Пример 1: Низкий риск**
- **Уязвимость**: SSH на порту 22 открыт только для локальной сети (192.168.1.0/24)
- **Угроза**: хакеры из интернета пытаются подключиться
- **Вероятность**: очень низкая (они не могут достучаться до порта)
- **Ущерб**: если бы смогли — высокий (полный контроль над сервером)
- **Риск**: низкий (вероятность × ущерб = 0.01 × 100 = 1)

**Пример 2: Высокий риск**
- **Уязвимость**: SSH открыт на весь интернет, пароль root — `123456`
- **Угроза**: ботнет перебирает пароли
- **Вероятность**: очень высокая (автоматизированные атаки происходят постоянно)
- **Ущерб**: высокий (полный контроль над сервером)
- **Риск**: критический (вероятность × ущерб = 0.9 × 100 = 90)

**Управление рисками** (Risk Management):
- **Снижение (Mitigation)**: закрыть уязвимость (обновить ПО, поставить firewall)
- **Принятие (Acceptance)**: если риск низкий, можно ничего не делать
- **Передача (Transfer)**: купить страховку от кибератак
- **Избегание (Avoidance)**: вообще не использовать технологию (например, не подключать критичные системы к интернету)

---

## 9.3.2. Классификация угроз по источнику

Угрозы приходят отовсюду. Давай разберём, **кто** и **что** угрожает твоим данным.

---

### 1. Внутренние угрозы (Insider Threats)

**Кто**: Сотрудники, подрядчики, партнёры — любой, у кого есть легитимный доступ к системе.

**Почему это опасно**: У инсайдеров уже есть доступ. Им не нужно ломать firewall или подбирать пароли. Они просто берут и копируют базу данных на флешку.

**Виды инсайдеров**:

**А) Злонамеренные (Malicious Insiders)**:
- **Недовольный сотрудник**: Увольняют программиста, он перед уходом удаляет production-базу или выкладывает исходный код на GitHub.
- **Инсайдер-шпион**: Сотрудник получает взятку от конкурентов и сливает им коммерческие секреты.
- **Саботаж**: Системный администратор встраивает бэкдор (backdoor), чтобы иметь доступ после увольнения.

**Б) Неосторожные (Negligent Insiders)**:
- **Фишинг**: Сотрудник кликает на письмо "Ваш аккаунт заблокирован, введите пароль здесь" → хакеры получают доступ.
- **Потеря устройства**: Оставил ноутбук с секретными документами в кафе.
- **Слабый пароль**: Использует `Password123` → хакеры подбирают пароль.
- **Случайное удаление**: Джуниор-разработчик выполнил `DROP DATABASE production;` вместо `DROP DATABASE test;`.

**Реальный пример 1: Tesla (2018)**
- **Что произошло**: Недовольный сотрудник **Мартин Трипп** (Martin Tripp) украл конфиденциальные данные производства Tesla и слил их журналистам.
- **Мотивация**: Считал, что Tesla скрывает проблемы с безопасностью батарей.
- **Итог**: Tesla подала в суд на $167 миллионов. Трипп проиграл.

**Реальный пример 2: Edward Snowden (2013)**
- **Кто**: Эдвард Сноуден, подрядчик АНБ (Агентство национальной безопасности США).
- **Что произошло**: Скопировал 1.7 миллиона секретных документов о массовой слежке АНБ за гражданами.
- **Итог**: Сноуден сбежал в Россию, получил политическое убежище. США объявили его предателем, правозащитники — героем.

**Как защититься**:
- **Принцип наименьших привилегий** (Least Privilege): каждый сотрудник имеет доступ только к тому, что нужно для работы.
- **Мониторинг**: логирование действий (кто что скачивал, изменял, удалял).
- **DLP (Data Loss Prevention)**: система, которая блокирует копирование конфиденциальных данных на флешки, отправку на личный email.
- **Обучение**: тренинги по фишингу, политике паролей.
- **Exit interview**: при увольнении сразу отключать доступы (аккаунты, пропуска, VPN).

---

### 2. Внешние угрозы (External Threats)

**Кто**: Злоумышленники, у которых **нет легитимного доступа** к системе. Им нужно сначала взломать систему, а потом уже красть данные.

**Виды внешних угроз**:

**А) Хакеры**

**Script Kiddies (Скрипт-кидди)**:
- **Кто**: Новички, которые используют готовые инструменты (Metasploit, Nmap, SQLMap) без глубокого понимания.
- **Мотивация**: "Прикольно взломать сайт и написать на главной странице 'Hacked by 1337_h4x0r'".
- **Опасность**: Низкая, но их много. Могут случайно нанести вред (например, DDoS-атака из любопытства).

**Хактивисты (Hacktivists)**:
- **Кто**: Хакеры с политическими мотивами.
- **Примеры**: **Anonymous** (взламывали сайты правительств, церкви Саентологии), **LulzSec**.
- **Мотивация**: Протест, месть, привлечение внимания к проблеме.
- **Опасность**: Средняя. Могут устроить DDoS, утечку данных, дефейс (замена главной страницы сайта).

**Кибепреступники (Cybercriminals)**:
- **Кто**: Профессиональные хакеры, цель — **деньги**.
- **Методы**: Ransomware (шифрование данных за выкуп), кража банковских карт, продажа баз данных на даркнете.
- **Опасность**: Высокая. Хорошо организованы, используют передовые методы.

**APT (Advanced Persistent Threat) — Государственные акторы**:
- **Кто**: Кибервойска, спецслужбы (Россия, США, Китай, Северная Корея, Израиль).
- **Цель**: Шпионаж, саботаж критической инфраструктуры (электростанции, военные системы).
- **Методы**: Очень продвинутые. Могут взламывать air-gapped системы (не подключённые к интернету), использовать 0-day уязвимости (неизвестные уязвимости).
- **Опасность**: Критическая. Но большинство компаний не интересны для APT (если ты не Газпром, Пентагон или завод по обогащению урана).

**Примеры APT**:
- **APT28 (Fancy Bear)** — Россия. Атаковали DNC (Демократическую партию США) в 2016 году, утечка писем Хиллари Клинтон.
- **APT29 (Cozy Bear)** — Россия. Атаковали SolarWinds (2020), взломали тысячи компаний и госорганизаций.
- **Lazarus Group** — Северная Корея. Взломали Sony Pictures (2014), WannaCry (2017), украли $81 миллион из Центрального банка Бангладеш.

**Б) Конкуренты (Промышленный шпионаж)**:
- **Кто**: Конкурирующие компании.
- **Цель**: Украсть коммерческие секреты (формулы, чертежи, базу клиентов, маркетинговую стратегию).
- **Методы**: Подкуп инсайдеров, взлом систем, социальная инженерия.

**Пример**: В 2019 году бывший сотрудник Apple **Сяолан Чжан** (Xiaolang Zhang) украл чертежи автономного автомобиля и попытался передать их китайской компании. Его арестовали в аэропорту.

---

### 3. Природные и техногенные угрозы

Не только люди угрожают твоим данным. Иногда природа и случайности делают это лучше любого хакера.

**Природные катастрофы**:
- **Пожар**: Сервера сгорели → все данные потеряны (если нет backup).
- **Наводнение**: Затопило дата-центр.
- **Землетрясение**: Разрушило здание с серверами.
- **Ураган, торнадо**: Повредили линии связи, отключили электричество.

**Техногенные**:
- **Отключение электричества**: Нет электричества → серверы выключились → данные могут повредиться (если нет ИБП — источника бесперебойного питания).
- **Авария в ЦОД**: Перегрев (сломался кондиционер), затопление (прорвало трубу).
- **Человеческая ошибка**: Системный администратор случайно удалил production-БД.

**Реальный пример: OVHcloud (2021)**
- **Что произошло**: В марте 2021 года в дата-центре **OVHcloud** (один из крупнейших хостинг-провайдеров Европы) в Страсбурге произошёл **пожар**.
- **Ущерб**: Сгорело **4 дата-центра**, потеряны данные **тысяч сайтов**.
- **Итог**: Сайты, у которых не было резервных копий в других дата-центрах, **потеряли всё**.

**Как защититься**:
- **Резервное копирование** (Backup): правило **3-2-1** (3 копии, 2 типа носителей, 1 offsite).
- **Географическая избыточность**: серверы в нескольких дата-центрах в разных городах/странах.
- **ИБП (UPS)**: источник бесперебойного питания (батареи, которые дадут время на graceful shutdown).
- **Генераторы**: дизель-генераторы для длительного отключения электричества.

---

## 9.3.3. Классификация угроз по типу воздействия (CIA Triad)

Угрозы нарушают один или несколько принципов **CIA Triad**: Конфиденциальность (Confidentiality), Целостность (Integrity), Доступность (Availability). Это из [Глава 9.01](09_01_политика_безопасности.md), но давай освежим память.

---

### 1. Нарушение конфиденциальности (Confidentiality)

**Что**: Несанкционированный доступ к данным. Кто-то прочитал то, что не должен был видеть.

**Примеры**:
- **Утечка данных (Data Breach)**: Хакеры украли базу с паролями, номерами кредитных карт, медицинскими записями.
- **Перехват трафика (Sniffing)**: Злоумышленник в кафе перехватывает HTTP-трафик (нешифрованный) и крадёт пароли.
- **Социальная инженерия**: Хакер позвонил в техподдержку, представился CEO и попросил сбросить пароль.

**Реальные примеры**:

**Equifax (2017)**:
- **Что**: Украдено 147 миллионов записей (ФИО, даты рождения, номера соцстрахования, адреса).
- **Как**: Уязвимость в Apache Struts (CVE-2017-5638), которую **не закрыли** несмотря на доступный патч.
- **Ущерб**: $700 миллионов штрафов, акции упали на 35%, CEO уволили.

**Facebook (2021)**:
- **Что**: Утекло 533 миллиона записей (имена, номера телефонов, email).
- **Как**: Использовали старую уязвимость (скрапинг данных через API).
- **Итог**: Данные попали на даркнет-форумы **бесплатно**.

**LastPass (2022)**:
- **Что**: Взломали хранилище паролей (password manager).
- **Как**: Хакеры украли резервные копии зашифрованных хранилищ. Если у пользователя слабый мастер-пароль, хакеры могут расшифровать.
- **Итог**: Паника среди пользователей, миграция на 1Password, Bitwarden.

**Как защититься**:
- **Шифрование**: HTTPS (TLS/SSL), шифрование диска (BitLocker, LUKS), шифрование БД.
- **Контроль доступа**: RBAC, принцип наименьших привилегий.
- **Многофакторная аутентификация (2FA/MFA)**: даже если пароль украли, без второго фактора не зайдут.
- **DLP (Data Loss Prevention)**: блокировка копирования конфиденциальных данных.

---

### 2. Нарушение целостности (Integrity)

**Что**: Несанкционированное **изменение** данных. Кто-то подменил, удалил или модифицировал информацию.

**Примеры**:
- **Man-in-the-Middle (MITM)**: Хакер перехватывает и **изменяет** данные между клиентом и сервером. Например, меняет номер счёта в банковском переводе.
- **SQL-инъекция**: Хакер изменяет SQL-запрос и меняет данные в БД (например, ставит себе баланс $1,000,000).
- **Подмена веб-страницы (Defacement)**: Хакеры взломали сайт и заменили главную страницу на "Hacked by ...".
- **Вирусы**: Модифицируют системные файлы, встраивают бэкдоры.

**Реальные примеры**:

**Stuxnet (2010)**:
- **Что**: Вирус, который атаковал иранские центрифуги для обогащения урана.
- **Как**: Модифицировал программу управления центрифугами (ПЛК — программируемые логические контроллеры), заставляя их вращаться с неправильной скоростью → центрифуги ломались.
- **Кто**: Предположительно США + Израиль (операция **Olympic Games**).
- **Итог**: Затормозил ядерную программу Ирана на несколько лет.

**NotPetya (2017)**:
- **Что**: Вирус-вымогатель (ransomware), который **притворялся**, что шифрует данные за выкуп. На самом деле **безвозвратно уничтожал** данные.
- **Цель**: Украина (атака через обновление бухгалтерской программы M.E.Doc).
- **Ущерб**: $10 миллиардов глобально. Пострадали Maersk (судоходная компания), Merck (фармацевтика), FedEx.

**Как защититься**:
- **Цифровые подписи**: проверка, что файл не изменён (GPG, коды подписи для ПО).
- **Хэши**: SHA-256 для проверки целостности файлов.
- **Контроль версий**: Git для кода, резервное копирование для БД.
- **Права доступа**: только администраторы могут изменять критичные файлы.
- **HTTPS**: защита от MITM (шифрование + аутентификация сервера).

---

### 3. Нарушение доступности (Availability)

**Что**: Легитимные пользователи **не могут получить доступ** к системе или данным.

**Примеры**:
- **DDoS (Distributed Denial of Service)**: Миллионы запросов в секунду → сервер падает.
- **Ransomware**: Вирус шифрует все файлы → требует выкуп в биткоинах. Пока не заплатишь — данные недоступны.
- **Сбой оборудования**: Жёсткий диск сломался, а резервной копии нет.
- **Отключение электричества**: Серверы выключились.

**Реальные примеры**:

**WannaCry (2017)**:
- **Что**: Ransomware-вирус, который использовал уязвимость **EternalBlue** (утёкшая от АНБ).
- **Масштаб**: 200,000 компьютеров в **150 странах**.
- **Жертвы**: NHS (британская система здравоохранения), испанская Telefónica, российские МВД/МЧС, Deutsche Bahn (железные дороги Германии).
- **Итог**: Компьютеры были зашифрованы, требовали $300 в биткоинах. Многие восстановили данные из backup, но некоторые потеряли всё.
- **Kill Switch**: Исследователь **Marcus Hutchins** нашёл домен, который останавливал вирус. Зарегистрировал домен за $10.69 → остановил распространение.

**Colonial Pipeline (2021)**:
- **Что**: Хакеры (группа **DarkSide**) зашифровали системы управления крупнейшим нефтепроводом США (45% топлива для восточного побережья).
- **Итог**: Трубопровод остановили на **5 дней**. Паника, очереди на заправках. Colonial Pipeline заплатила выкуп **$4.4 миллиона** в биткоинах.
- **Продолжение**: ФБР вернуло **$2.3 миллиона** (отследили кошелёк хакеров).

**GitHub DDoS (2018)**:
- **Что**: Крупнейшая DDoS-атака в истории — **1.35 Тбит/с**.
- **Метод**: Memcached amplification (усиление атаки через неправильно настроенные Memcached-серверы).
- **Итог**: GitHub был недоступен **8 минут**, затем Akamai (DDoS-защита) отразила атаку.

**Как защититься**:
- **DDoS-защита**: Cloudflare, Akamai, AWS Shield.
- **Резервное копирование (Backup)**: правило 3-2-1, offsite backup.
- **Репликация**: несколько копий БД на разных серверах.
- **RAID-массивы**: если один диск сломался, данные остаются на других.
- **ИБП (UPS)** и генераторы: защита от отключения электричества.
- **Антивирусы, IDS/IPS**: обнаружение и блокировка ransomware.

---

## 9.3.4. Модель угроз (Threat Model)

**Threat Model** — это **формализованное описание** того, **от чего** ты защищаешься, **кто** может атаковать и **как**.

**Зачем нужна модель угроз?**

Нельзя защититься от **всего**. Если ты делаешь блог о котиках, тебе не нужна защита уровня Пентагона (air-gapped системы, биометрия, физическая охрана). Но если ты банк, тебе нужна максимальная защита.

**Модель угроз помогает**:
- Определить, **какие активы** критичны (база клиентов, финансовые данные, исходный код)
- Понять, **кто** может атаковать (script kiddies, киберпреступники, конкуренты, APT)
- Выявить **уязвимости** (открытые порты, слабые пароли, устаревшее ПО)
- Приоритизировать **риски** (что защищать в первую очередь)

---

### Этапы построения модели угроз

**1. Определение активов (Assets)**

**Вопросы**:
- Что нужно защищать?
- Какова ценность каждого актива?
- Что произойдёт, если актив будет скомпрометирован?

**Пример (интернет-магазин)**:
- **База данных клиентов** (ФИО, адреса, email, телефоны, история заказов) → критично
- **Платёжная информация** (номера карт) → критично (если утечка → штрафы по PCI DSS, потеря доверия)
- **Исходный код сайта** → средняя важность
- **Логи сервера** → низкая важность

---

**2. Определение злоумышленников (Adversaries)**

**Вопросы**:
- Кто может атаковать?
- Какова их мотивация?
- Какой уровень знаний и ресурсов у них?

**Примеры**:

| Злоумышленник | Мотивация | Уровень | Ресурсы |
|---------------|-----------|---------|---------|
| **Script Kiddie** | Хулиганство, слава | Низкий | Готовые инструменты |
| **Киберпреступник** | Деньги | Средний-Высокий | Автоматизация, покупка 0-day |
| **Конкурент** | Промышленный шпионаж | Средний | Подкуп инсайдеров |
| **APT (государство)** | Шпионаж, саботаж | Очень высокий | Бюджеты, 0-day, физический доступ |
| **Инсайдер** | Месть, деньги | Средний | Легитимный доступ |

**Для блога о котиках**: реальная угроза — только script kiddies (автоматические боты ищут уязвимости).  
**Для банка**: угроза от киберпреступников, APT, инсайдеров.

---

**3. Определение векторов атак (Attack Vectors)**

**Вопрос**: Как злоумышленник может атаковать?

**Примеры векторов атак**:
- **Веб-приложение**: SQL-инъекция, XSS, CSRF
- **Сеть**: DDoS, Man-in-the-Middle, снифинг
- **Социальная инженерия**: Фишинг, вишинг (голосовой фишинг), претекстинг
- **Физический доступ**: Кража ноутбука, подключение USB-флешки с вирусом
- **Инсайдер**: Копирование данных на флешку, удаление БД

---

**4. Приоритизация рисков (Risk Prioritization)**

**Вопросы**:
- Какие риски наиболее вероятны?
- Какие нанесут наибольший ущерб?
- Что защищать в первую очередь?

**Матрица рисков**:

|              | **Низкий ущерб** | **Средний ущерб** | **Высокий ущерб** |
|--------------|------------------|-------------------|-------------------|
| **Высокая вероятность** | Средний риск | Высокий риск | **Критический риск** |
| **Средняя вероятность** | Низкий риск | Средний риск | Высокий риск |
| **Низкая вероятность** | Низкий риск | Низкий риск | Средний риск |

**Пример**:
- **SQL-инъекция на форме логина** (высокая вероятность, высокий ущерб) → **критический риск** → защищаемся в первую очередь (параметризованные запросы, WAF).
- **APT атака на блог о котиках** (низкая вероятность, низкий ущерб) → **низкий риск** → можно не париться.

---

## 9.3.5. TOP-10 OWASP: Самые частые уязвимости веб-приложений

**OWASP** (Open Web Application Security Project) — некоммерческая организация, которая публикует список **TOP-10** самых опасных уязвимостей веб-приложений. Обновляется раз в несколько лет.

**Последняя версия**: OWASP Top 10 (2021).

Давай пройдёмся по списку.

---

### 1. Broken Access Control (Неправильное управление доступом)

**Что**: Пользователь может получить доступ к данным/функциям, которые ему не положены.

**Примеры**:
- Изменил URL `https://site.com/profile?id=123` → `id=124` → увидел профиль чужого пользователя.
- API не проверяет, имеет ли пользователь право удалять записи → любой может удалить любую запись.

**Как защититься**:
- Проверять права доступа **на сервере** (не на клиенте!).
- Использовать **авторизацию** (проверка, что пользователь имеет право на действие).

---

### 2. Cryptographic Failures (Ошибки шифрования)

**Что**: Неправильное использование шифрования или его отсутствие.

**Примеры**:
- Пароли хранятся в открытом виде (plaintext) или с MD5 (сломан).
- Сайт не использует HTTPS → пароли передаются открытым текстом.
- Используется слабое шифрование (DES вместо AES).

**Как защититься**:
- **HTTPS** (TLS 1.2 или 1.3).
- Хранить пароли с **bcrypt/Argon2** (хэш + соль).
- Шифровать чувствительные данные в БД.

---

### 3. Injection (Инъекция)

**Что**: Злоумышленник вставляет вредоносный код в запрос.

**Виды**:
- **SQL-инъекция**: изменение SQL-запроса.
- **NoSQL-инъекция**: для MongoDB и др.
- **LDAP-инъекция**: для LDAP-запросов.
- **OS Command Injection**: выполнение команд ОС.

**Пример SQL-инъекции**:
```python
# Уязвимый код:
username = request.GET['username']
query = f"SELECT * FROM users WHERE username = '{username}'"
```

Хакер вводит: `admin' OR '1'='1`  
Результат: `SELECT * FROM users WHERE username = 'admin' OR '1'='1'`  
→ Условие всегда истинно → хакер видит всех пользователей.

**Как защититься**:
- **Параметризованные запросы** (prepared statements).
- **ORM** (Объектно-реляционное отображение): Django ORM, SQLAlchemy.
- **Валидация ввода**: проверять, что `username` содержит только буквы/цифры.

---

### 4. Insecure Design (Небезопасный дизайн)

**Что**: Ошибки в архитектуре системы (не реализация, а **дизайн**).

**Пример**: Система восстановления пароля по "секретным вопросам" ("Девичья фамилия матери"). Хакер гуглит информацию о жертве → восстанавливает пароль.

**Как защититься**:
- **Threat modeling** на этапе проектирования.
- **Secure by design**: изначально встраивать безопасность.

---

### 5. Security Misconfiguration (Неправильная конфигурация)

**Что**: Ошибки в настройке системы.

**Примеры**:
- Дефолтный пароль **admin/admin**.
- Открыт SSH (порт 22) на весь интернет.
- Оставлена консоль отладки (Django Debug Mode в production).
- Не отключены ненужные сервисы (Telnet, FTP).

**Реальный пример**: В 2017 году AWS S3-бакеты оставляли **публичными** по умолчанию → утечки данных (Verizon, Accenture, Dow Jones).

**Как защититься**:
- **Минимизация**: отключить всё, что не используется.
- **Hardening**: следовать гайдам по безопасной настройке (CIS Benchmarks).
- **Автоматизация**: Infrastructure as Code (Terraform, Ansible) → настройки в коде → меньше ошибок.

---

### 6. Vulnerable and Outdated Components (Устаревшие компоненты)

**Что**: Использование библиотек/фреймворков с известными уязвимостями.

**Примеры**:
- **Equifax (2017)**: Apache Struts с уязвимостью **CVE-2017-5638**.
- **Log4Shell (2021)**: уязвимость в Log4j (Java-библиотека для логирования) → удалённое выполнение кода.

**Как защититься**:
- **Регулярные обновления**: `apt update && apt upgrade`, `npm audit fix`.
- **Vulnerability scanners**: Dependabot (GitHub), Snyk, OWASP Dependency-Check.
- **Минимизация зависимостей**: используй только нужные библиотеки.

---

### 7. Identification and Authentication Failures (Ошибки аутентификации)

**Что**: Слабая или сломанная аутентификация.

**Примеры**:
- Слабые пароли (`123456`, `password`).
- Нет ограничения попыток входа → brute force.
- Сессионный токен передаётся в URL (`site.com/?session=abc123`) → можно украсть из истории браузера.
- Нет 2FA.

**Как защититься**:
- **Сильные пароли**: минимум 12 символов, сложность.
- **2FA/MFA**.
- **Rate limiting**: блокировка после N неудачных попыток (Fail2Ban).
- **Хранение токенов в cookies** (HttpOnly, Secure, SameSite).

---

### 8. Software and Data Integrity Failures (Нарушение целостности ПО и данных)

**Что**: Использование непроверенного ПО, отсутствие проверки целостности.

**Примеры**:
- Загрузка библиотек с CDN без проверки хэша → CDN взломали → пользователям подсунули вредоносный JS.
- CI/CD без проверки (злоумышленник изменил код в репозитории → код автоматически задеплоился на production).

**Как защититься**:
- **Subresource Integrity (SRI)**: `<script src="..." integrity="sha384-..."></script>`.
- **Подпись кода**: проверять цифровую подпись.
- **Проверка целостности**: хэши (SHA-256) при скачивании.

---

### 9. Security Logging and Monitoring Failures (Отсутствие логирования и мониторинга)

**Что**: Система не логирует события → невозможно обнаружить атаку.

**Примеры**:
- Не логируются попытки входа → хакеры перебирают пароли, никто не замечает.
- Логи не анализируются → атака произошла 3 месяца назад, узнали только сейчас.

**Как защититься**:
- **Логирование**: успешные/неудачные попытки входа, изменения данных, доступ к критичным файлам.
- **SIEM**: Elasticsearch + Logstash + Kibana (ELK), Splunk.
- **Алерты**: автоматические уведомления при подозрительной активности.

---

### 10. Server-Side Request Forgery (SSRF)

**Что**: Хакер заставляет сервер отправить запрос куда-то (например, к внутренним ресурсам).

**Пример**:
Сайт позволяет загрузить изображение по URL:
```
site.com/download?url=https://example.com/image.jpg
```

Хакер вводит:
```
site.com/download?url=http://169.254.169.254/latest/meta-data/
```

Это **AWS метадата-сервис** (доступен только изнутри). Сервер выполнит запрос → хакер получит AWS-ключи.

**Как защититься**:
- **Whitelist**: разрешить только определённые домены.
- **Запретить** доступ к приватным IP (192.168.x.x, 127.0.0.1, 169.254.169.254).

---

## 9.3.6. Реальные примеры угроз и взломов

Теория — это круто, но давай посмотрим на **реальные** инциденты. Это покажет, что угрозы — не абстрактная хрень, а вполне конкретные пиздецы, которые случаются каждый день.

---

### 1. Equifax (2017) — Утечка 147 миллионов записей

**Что произошло**:
- Хакеры использовали уязвимость в **Apache Struts** (веб-фреймворк).
- Уязвимость **CVE-2017-5638** была **известна** и **закрыта патчем** за 2 месяца до атаки.
- Администраторы Equifax **не обновили** систему.
- Хакеры **3 месяца** сидели в системе, собирали данные.

**Что украли**:
- ФИО, даты рождения, адреса, номера соцстрахования (SSN)
- 147 миллионов американцев (почти половина населения США)

**Итог**:
- Штраф $700 миллионов
- Акции упали на 35%
- CEO Ричард Смит уволили (но с золотым парашютом $90 миллионов)

**Урок**: **Обновляй софт!** Если есть патч — ставь его немедленно.

---

### 2. WannaCry (2017) — Ransomware, 200,000 компьютеров

**Что произошло**:
- Вирус-вымогатель (ransomware), шифрует файлы → требует $300 в биткоинах.
- Использовал **EternalBlue** (эксплойт от АНБ, утёкший хакерам из группы Shadow Brokers).
- Распространялся **без участия пользователя** (wormable).

**Масштаб**:
- 200,000 компьютеров в **150 странах**.
- NHS (британское здравоохранение): отменили операции, скорая помощь перенаправлялась в другие больницы.
- Испанская Telefonica, российские МВД/МЧС, Deutsche Bahn (железные дороги Германии).

**Kill Switch**:
- Исследователь **Marcus Hutchins** (@MalwareTechBlog) нашёл, что вирус проверяет существование домена `iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com`.
- Если домен существует → вирус останавливается.
- Hutchins зарегистрировал домен за **$10.69** → остановил распространение.

**Ирония**: Год спустя Hutchins был арестован в США за создание банковского трояна **Kronos** в 2014 году (до того, как остановил WannaCry). Получил условный срок.

**Урок**: Обновляй Windows. Патч для EternalBlue вышел **за месяц до атаки** (MS17-010).

---

### 3. Colonial Pipeline (2021) — Ransomware, остановка нефтепровода

**Что произошло**:
- Хакеры (группа **DarkSide**) зашифровали системы управления **Colonial Pipeline** (крупнейший нефтепровод США, 45% топлива для восточного побережья).
- Компания **остановила** трубопровод на **5 дней**.

**Итог**:
- Паника, очереди на заправках, рост цен на бензин.
- Colonial Pipeline заплатила выкуп **$4.4 миллиона** в биткоинах.
- ФБР вернуло **$2.3 миллиона** (отследили кошелёк).

**Как зашли?**:
- Украли **VPN-пароль** одного из сотрудников.
- Пароль был **в утёкшей базе** (сотрудник использовал тот же пароль на другом сайте).

**Урок**:
- Не используй одинаковые пароли на разных сайтах.
- Включай 2FA для VPN.

---

### 4. LastPass (2022) — Взлом менеджера паролей

**Что произошло**:
- Хакеры взломали **инженера LastPass** (через вредоносный софт на личном компьютере).
- Украли **резервные копии** зашифрованных хранилищ паролей.
- Данные **зашифрованы**, но если у пользователя **слабый мастер-пароль** → хакеры могут расшифровать (brute force).

**Что под угрозой**:
- Все пароли пользователя.
- Если мастер-пароль `password123` → хакеры расшифруют за минуты.
- Если мастер-пароль `Tr0ub4dor&3` → может потребоваться несколько лет.

**Итог**:
- Паника среди пользователей.
- Массовая миграция на **1Password**, **Bitwarden**.
- LastPass рекомендовала сменить мастер-пароль и все пароли в хранилище.

**Урок**: Даже менеджеры паролей могут быть взломаны. Используй **длинный** мастер-пароль (16+ символов).

---

### 5. MOVEit (2023) — Утечка данных тысяч компаний

**Что произошло**:
- **MOVEit Transfer** — ПО для безопасной передачи файлов (используют банки, госорганизации, корпорации).
- Найдена уязвимость **SQL-инъекция** (CVE-2023-34362).
- Хакеры (группа **Cl0p**) использовали уязвимость → украли данные **тысяч компаний**.

**Жертвы**:
- British Airways, BBC, Shell, университеты, государственные органы США.
- Более **60 миллионов** человек пострадали.

**Итог**:
- Хакеры требовали выкуп от каждой компании.
- Некоторые заплатили, некоторые отказались.

**Урок**: Даже "безопасное" ПО может иметь уязвимости. Не доверяй слепо.

---

## 9.3.7. Оценка рисков

Угроз тысячи, но **невозможно защититься от всех**. Нужно **приоритизировать**.

**Оценка рисков (Risk Assessment)** — процесс определения, **какие угрозы наиболее опасны**.

---

### Формула риска

```
Риск = Вероятность × Ущерб
```

**Вероятность** — насколько вероятно, что угроза произойдёт (0% — 100%).  
**Ущерб** — какой урон нанесёт угроза (в деньгах, времени, репутации).

---

### Пример расчёта рисков

**Сценарий**: Интернет-магазин.

**Угроза 1: SQL-инъекция на форме логина**
- **Вероятность**: 80% (автоматические сканеры ищут уязвимости)
- **Ущерб**: Высокий (хакеры могут украсть базу клиентов, изменить цены, удалить заказы)
- **Риск**: 0.8 × 100 = **80 (критический)**

**Угроза 2: Пожар в офисе (где стоит сервер)**
- **Вероятность**: 1% (пожары редки)
- **Ущерб**: Высокий (серверы сгорят, данные потеряны)
- **Риск**: 0.01 × 100 = **1 (низкий)**

**Угроза 3: DDoS-атака**
- **Вероятность**: 20% (конкуренты могут заказать DDoS)
- **Ущерб**: Средний (сайт ляжет на несколько часов, потеря продаж)
- **Риск**: 0.2 × 50 = **10 (средний)**

---

### Матрица рисков

|              | **Низкий ущерб (1-30)** | **Средний ущерб (31-70)** | **Высокий ущерб (71-100)** |
|--------------|-------------------------|---------------------------|----------------------------|
| **Высокая вероятность (> 50%)** | Средний риск | Высокий риск | **Критический риск** |
| **Средняя вероятность (20-50%)** | Низкий риск | Средний риск | Высокий риск |
| **Низкая вероятность (< 20%)** | Низкий риск | Низкий риск | Средний риск |

---

### Приоритизация

**Критический риск (SQL-инъекция)**:
- **Действие**: Исправить **немедленно** (параметризованные запросы, WAF).

**Средний риск (DDoS)**:
- **Действие**: Подключить Cloudflare (DDoS-защита).

**Низкий риск (пожар)**:
- **Действие**: Резервное копирование в облако (AWS S3, offsite).

---

## Ключевые термины

- **Информационная безопасность (ИБ)** — защита информации от несанкционированного доступа, изменения, уничтожения
- **CIA Triad** — Конфиденциальность (Confidentiality), Целостность (Integrity), Доступность (Availability)
- **Актив (Asset)** — всё, что имеет ценность и нуждается в защите
- **Уязвимость (Vulnerability)** — слабое место в системе
- **Угроза (Threat)** — потенциальная опасность
- **Риск (Risk)** — вероятность × ущерб
- **Инсайдер (Insider)** — сотрудник или подрядчик с легитимным доступом
- **Script Kiddie** — новичок-хакер, использующий готовые инструменты
- **Хактивист (Hacktivist)** — хакер с политическими мотивами
- **APT (Advanced Persistent Threat)** — продвинутая угроза (государственные акторы)
- **Ransomware** — вирус-вымогатель (шифрует данные за выкуп)
- **DDoS (Distributed Denial of Service)** — распределённая атака отказа в обслуживании
- **SQL-инъекция** — вставка вредоносного SQL-кода
- **Модель угроз (Threat Model)** — формализованное описание угроз
- **OWASP Top 10** — список 10 самых опасных уязвимостей веб-приложений
- **MITM (Man-in-the-Middle)** — атака посредника (перехват и изменение данных)
- **Zero-day (0-day)** — уязвимость, неизвестная разработчикам (нет патча)
- **Kill Switch** — механизм аварийной остановки (как в WannaCry)

---

## Контрольные вопросы

**Теоретические:**

1. **Что такое информационная безопасность?** Объясни связь с CIA Triad.

2. **В чём разница между уязвимостью, угрозой и риском?** Приведи примеры.

3. **Классифицируй угрозы по источнику.** Кто опаснее: инсайдер или внешний хакер? Почему?

4. **Объясни три типа воздействия на CIA Triad.** Приведи по одному реальному примеру нарушения конфиденциальности, целостности и доступности.

5. **Что такое модель угроз (Threat Model)?** Зачем она нужна?

6. **Что такое OWASP Top 10?** Назови 5 уязвимостей из списка.

7. **Что такое APT (Advanced Persistent Threat)?** Чем APT отличается от обычных хакеров?

8. **Что такое ransomware?** Приведи примеры (WannaCry, Colonial Pipeline).

**Практические:**

9. **Задача: Оценка рисков.**  
   У тебя веб-приложение. Есть три угрозы:
   - **A**: SQL-инъекция (вероятность 70%, ущерб $100,000)
   - **B**: DDoS-атака (вероятность 30%, ущерб $10,000)
   - **C**: Физическая кража сервера (вероятность 5%, ущерб $50,000)
   
   Рассчитай риски и расставь приоритеты (что исправлять в первую очередь).

**Решение**:
- **A**: Риск = 0.7 × 100,000 = **$70,000** (критический)
- **B**: Риск = 0.3 × 10,000 = **$3,000** (средний)
- **C**: Риск = 0.05 × 50,000 = **$2,500** (низкий)

**Приоритет**: A → B → C.

10. **Задача: Модель угроз для блога.**  
    Ты делаешь блог о программировании. Определи:
    - Какие активы нужно защищать?
    - Кто может атаковать? (Реалистично!)
    - Какие угрозы наиболее вероятны?
    - Какие меры защиты необходимы?

**Примерное решение**:
- **Активы**: контент (статьи), аккаунт администратора, база комментариев.
- **Угрозы**: script kiddies (автоматические боты ищут уязвимости), спам-боты.
- **Вероятные атаки**: брутфорс пароля админки, SQL-инъекция (если есть формы), DDoS (маловероятно, если блог не популярен).
- **Меры**: HTTPS, сильный пароль + 2FA, обновления WordPress/плагинов, резервное копирование.

11. **Задача: WannaCry.**  
    Прочитай про **WannaCry** (раздел 9.3.6). Ответь:
    - Какая уязвимость использовалась?
    - Как можно было предотвратить заражение?
    - Что такое "kill switch" и как он остановил вирус?

**Решение**:
- **Уязвимость**: EternalBlue (SMBv1 в Windows), патч MS17-010.
- **Предотвращение**: обновить Windows (патч вышел **за месяц до атаки**), отключить SMBv1.
- **Kill Switch**: вирус проверял домен `iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com`. Если домен существует → вирус останавливается. Marcus Hutchins зарегистрировал домен → вирус остановился.

12. **Задача: Защита от инсайдера.**  
    В компании работает 50 сотрудников. У всех есть доступ к общей папке с финансовыми отчётами. Один из сотрудников может слить данные конкурентам. Как защититься?

**Примерное решение**:
- **Принцип наименьших привилегий**: не все 50 сотрудников должны иметь доступ к финансам. Только финансовый директор, бухгалтеры, CEO.
- **DLP (Data Loss Prevention)**: блокировать копирование на USB, отправку на личный email.
- **Мониторинг**: логировать, кто открывал файлы, кто скачивал.
- **Водяные знаки (Watermarking)**: если файл утечёт, можно понять, кто слил (в документ встраивается уникальный ID сотрудника, невидимый глазом).
- **NDA (Non-Disclosure Agreement)**: договор о неразглашении с юридической ответственностью.

---

**Статус**: Глава готова ✅  
**Дата**: 15 января 2026  
**Автор**: AI Assistant (Claude Sonnet 4.5)

**Следующая глава**: 9.04 Противодействие нарушению конфиденциальности (методы защиты от утечек данных, шифрование, контроль доступа, DLP).


---

[← К оглавлению](README.md)

*Глава 9.3: . Понятия информационной безопасности. Угрозы*
